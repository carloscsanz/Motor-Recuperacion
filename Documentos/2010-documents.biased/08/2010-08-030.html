

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head id="ctl00_Head1"><link id="ctl00_HeaderLink1" rel="stylesheet" type="text/css" href="http://i3.msdn.microsoft.com/Global/Global-bn20100217.css" /><link id="ctl00_HeaderLink2" rel="stylesheet" type="text/css" href="http://i3.msdn.microsoft.com/Platform/MasterPages/Library/Library-bn20100217.css" /><meta name="NormalizedUrl" content="http://msdn.microsoft.com/en-us/library(d=default)/attbb8f5(l=en-us,v=VS.90).aspx" /><meta name="VotingContextUrl" content="http://msdn.microsoft.com/en-us/library(d=default)/attbb8f5(l=en-us,v=VS.90).aspx" /><meta name="ROBOTS" content="NOINDEX,NOFOLLOW" /><meta name="MN" content="D1DC1173-6:31:33 AM" /><meta name="ms.locale" content="en-us" /><meta name="Search.ShortId" content="attbb8f5" />
<!-- Looking for metadata? Use the robot view instead http://currentsite/currenturl(robot).aspx -->
<meta name="DCS.dcsuri" content="/en-us/library(d=default)/attbb8f5(l=en-us,v=VS.90).aspx" />
<link rel="stylesheet" type="text/css" href="http://i3.msdn.microsoft.com/en-us/library/mtps-bn20100217.css?l=en-us&amp;i=library&amp;ct=AlternateSelector;CCEditor;CCItem;CCSection;CCTagEditor;CodeSnippet;CollapsibleArea;ContentFallback;DropDownFilter;ExpandCollapseAll;Eyebrow;Footer;InstrumentedLink;InteractiveToolbar;iRootBrand;KTableControl;LanguageSpecificText;LocaleManagementFlyout;lwViewSwitcher;MastheadLibrary;MemberlistFrameworksFilter;MemberlistMembersFilter;MtpsLoginStatus;MtpsRating;MtViewDropDown;Omniture;RedVelvetCodeSnippet;RedVelvetCollapsibleArea;RedVelvetInstrumentedLink;RelatedPages;ResizeableAreaD10;StoSearch;StoTabStripLibrary;SurveyLauncher;TagCloud;TemplatedFlyout;Tickler;Toc;UserRecognition;WebMetrix;WebTrends&amp;clustimg=1"></link><link rel="alternate" media="print" href="/en-us/library/system.net.sockets.socket(printer).aspx" />
<title>
	Socket Class (System.Net.Sockets)
</title></head>
<body id="ctl00_Mtps_body" dir="ltr">

  <form name="aspnetForm" method="post" action="system.net.sockets.socket.aspx" id="aspnetForm">
<input type="hidden" name="flag" id="flag" value="false" />
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUBMGQYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgEFHmN0bDAwJGN0bDEwJGN0bDAwJFNlYXJjaEJ1dHRvblD2rr1tyawxDEN4ldMIbGuYUKm9" />


<script type="text/javascript">
//<![CDATA[
var CurUserId="AxUFAAAAAAA6CgAAYXOiFtlLFDc34biAWIWL9w!!";var ClientURL="http%3a%2f%2fmsdn.microsoft.com%2fen-us%2flibrary(d%3ddefault)%2fattbb8f5(l%3den-us%2cv%3dVS.90).aspx";var maxRating=5;var RatingObjId="ctl00_ib1_Flyout_Rating1";var tbCommentsId="ctl00_ib1_Flyout_tbComments";var PageId="attbb8f5";var pageTag="contentRatingattbb8f5VS.90en-us";var sendBtnId="ctl00_ib1_Flyout_btnSend";var curRating="4";var contentRated=false;var RatingTooltipText="Click a star and provide feedback";var RatedTooltipText="You have already rated this content. Thank you for your feedback.";var userIPAddress="84.77.3.46";var MtpsPageDirection="ltr";var RatingFlyoutID="ctl00_ib1_Flyout";var Rating_Device="default";var CCI_DeleteConfirmationText="Are you sure you want to delete?";function wkAddNewItemClick(){CCE_EditAnnotation(-1);};
var CCS_AddLinkID="ctl00_WikiContent_Add";var CCS_User="";var CCS_ContentUrl="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.aspx";//]]>
</script>

<script src="http://i2.msdn.microsoft.com/Platform/cjs/jquery-1.2.6-bn20100217.js" type="text/javascript"></script>
<script src="http://i2.msdn.microsoft.com/Platform/cjs/Silverlight-bn20100217.js" type="text/javascript"></script>
<script type="text/javascript">
//<![CDATA[
var wt_nvr_ru = "WT_NVR_RU";var wt_fpcdom = ".microsoft.com";var wt_domlist = "msdn.microsoft.com";var wt_pathlist = "";var wt_paramlist = "DCSext.mtps_devcenter";var wt_siteid = "MSDN";var gDomain="m.webtrends.com";
var gDcsId="dcsmgru7m99k7mqmgrhudo0k8_8c6m";
var gFpc="WT_FPC";
/*<![CDATA[*/
if(document.cookie.indexOf(gFpc+"=")==-1){document.write("<scr"+"ipt type='text/javascript' src='"+"http"+(window.location.protocol.indexOf('https:')==0?'s':'')+"://"+gDomain+"/"+gDcsId+"/wtid.js"+"'><\/scr"+"ipt>");}
/*]]>*/
var detectedLocale = 'en-us';
var wtsp="_msdnlib_es_dev_net_";
var gTrackEvents = 0;
var omni_guid='08f23150-a5c5-4bf1-a3a8-a12d86b58ca4';//]]>
</script>
<SCRIPT LANGUAGE='JavaScript' SRC='http://i2.msdn.microsoft.com/platform/Controls/Omniture/resources/MSDN/omni_rsid_msdn-bn20100217.js'></SCRIPT><noscript><a href='http://www.omniture.com' title='Web Analytics'><img src='http://msstonojsmsdn.112.2o7.net/b/ss/msstonojsmsdn/1/H.20.2--NS/0'  height='1' width='1' border='0' alt='' /></a></noscript>
<script type="text/javascript">
//<![CDATA[
var CCT_Browse="Browse other topics containing this tag";var CCT_Remove="Remove the tag from this topic";var CCT_NoTags="No tags entered";var CCT_Error="An error has occurred";var CCT_BugTag="contentbug";var CCE_ErrSameContent = "Content has not changed";
var CCE_ErrEmptyTitle = "Title can not be empty";
var CCE_ErrEmptyContent = "Content cannot be empty";
var CCE_ErrTitleTooLong = "Title is limited to 100 characters";
var CCE_ErrContentTooLong = "Content is limited to 50,000 characters";
var CCE_ErrServerError = "Error occurred while saving your data.";
var CCE_IsEditing=false;var CCE_IsTaggingEnabled=true;var CCE_TitleMaxLen=100;var CCE_ContentMaxLen=50000;var CCE_UpdateText="Please Wait";//]]>
</script>

<script src="http://i2.msdn.microsoft.com/platform/cjs/extract/compositejscript2.js" type="text/javascript"></script>
<input type="hidden" name="__PREVIOUSPAGE" id="__PREVIOUSPAGE" value="C_bTL8Qs9tR5kl6Pqyeu1nGuwwI40hUWJWjg14bk2vb-gqhDGGfHgTkyymyG--Tx0" />
  
   
  <div id="rheader">
    

<div class="mastheadfontbase">
  <div>
		<div class="GlobalBar">
			<div class="Teaser">
				

<span id="ticklerWrapper" >
<a id="ctl00_ctl10_Tickler1_InstallLink" class="slLink" href="http://clk.atdmt.com/MRT/go/141489558/direct/01/" onclick="javascript:Track('ctl00_ctl10_Tickler1|_InstallLink',this);">Upgrade your Internet Experience</a>
</span>


			</div>
			<div class="GlobalBarRight">
			  <div class="LocaleFlyout">
				  <div class="LocaleManagementFlyoutStatic" style="position:relative;" id="ctl00_ctl10_LocaleManagement_ctl00"><a class="LocaleManagementFlyoutStaticLink" href="javascript:void(0)">United States - English&nbsp;</a><img class="LocaleManagementFlyoutPopArrow LibC_popdownarrow" src="http://i.msdn.microsoft.com/Global/Images/clear.gif" alt="Dropdown Arrow" height="4" width="7" border="0" /><div id="ctl00_ctl10_LocaleManagement_ctl00_Popup" class="LocaleManagementFlyoutPopup" style="position: absolute;visibility:hidden;left:-1000px;">
		<table border="0" width="175">
			<tr>
				<td><a href="javascript:__doPostBack('ctl00$ctl10$LocaleManagement$ctl00$ctl05','')">Argentina (Español)</a></td>
			</tr><tr>
				<td><a href="javascript:__doPostBack('ctl00$ctl10$LocaleManagement$ctl00$ctl06','')">Australia (English)</a></td>
			</tr><tr>
				<td><a href="javascript:__doPostBack('ctl00$ctl10$LocaleManagement$ctl00$ctl07','')">Brasil (Português)</a></td>
			</tr><tr>
				<td><a href="javascript:__doPostBack('ctl00$ctl10$LocaleManagement$ctl00$ctl08','')">Canada (English)</a></td>
			</tr><tr>
				<td><a href="javascript:__doPostBack('ctl00$ctl10$LocaleManagement$ctl00$ctl09','')">Canada (Français)</a></td>
			</tr><tr>
				<td><a href="javascript:__doPostBack('ctl00$ctl10$LocaleManagement$ctl00$ctl10','')">中国 (简体中文)</a></td>
			</tr><tr>
				<td><a href="javascript:__doPostBack('ctl00$ctl10$LocaleManagement$ctl00$ctl11','')">Colombia (Español)</a></td>
			</tr><tr>
				<td><a href="javascript:__doPostBack('ctl00$ctl10$LocaleManagement$ctl00$ctl12','')">Deutschland (Deutsch)</a></td>
			</tr><tr>
				<td><a href="javascript:__doPostBack('ctl00$ctl10$LocaleManagement$ctl00$ctl13','')">España (Español)</a></td>
			</tr><tr>
				<td><a href="javascript:__doPostBack('ctl00$ctl10$LocaleManagement$ctl00$ctl14','')">France (Français)</a></td>
			</tr><tr>
				<td><a href="javascript:__doPostBack('ctl00$ctl10$LocaleManagement$ctl00$ctl15','')">India (English)</a></td>
			</tr><tr>
				<td><a href="javascript:__doPostBack('ctl00$ctl10$LocaleManagement$ctl00$ctl16','')">Italia (Italiano)</a></td>
			</tr><tr>
				<td><a href="javascript:__doPostBack('ctl00$ctl10$LocaleManagement$ctl00$ctl17','')">日本 (日本語)</a></td>
			</tr><tr>
				<td><a href="javascript:__doPostBack('ctl00$ctl10$LocaleManagement$ctl00$ctl18','')">México (Español)</a></td>
			</tr><tr>
				<td><a href="javascript:__doPostBack('ctl00$ctl10$LocaleManagement$ctl00$ctl19','')">Perú (Español)</a></td>
			</tr><tr>
				<td><a href="javascript:__doPostBack('ctl00$ctl10$LocaleManagement$ctl00$ctl20','')">Россия (Pусский)</a></td>
			</tr><tr>
				<td><a href="javascript:__doPostBack('ctl00$ctl10$LocaleManagement$ctl00$ctl21','')">United Kingdom (English)</a></td>
			</tr><tr>
				<td><a href="javascript:__doPostBack('ctl00$ctl10$LocaleManagement$ctl00$ctl22','')">United States (English)</a></td>
			</tr><tr>
				<td class="LocaleManagementFlyoutPopupHr"></td>
			</tr><tr>
				<td><a href="/en-us/ms376822.aspx">More...</a></td>
			</tr>
		</table></div><div id="ctl00_ctl10_LocaleManagement_ctl00_Anim" class="TFlyPopupAnimate"></div>
</div>



		    </div>
		    <div class="SiteMap">
				  <a id="ctl00_ctl10_MSFT_Site" title="Microsoft.com" class="SiteMapLink" href="http://www.microsoft.com">Microsoft.com</a>
			  </div>
			  <div class="PassportScarab">
				  <span id="ctl00_ctl10_UserRecognitionFlyout_lbwelcom" class="UserRecognitionStaticText">Welcome</span>

  
  
<a id="idPPScarab" href="http://login.live.com/login.srf?wa=wsignin1.0&amp;rpsnv=11&amp;ct=1268573493&amp;rver=6.0.5276.0&amp;wp=MCLBI&amp;wlcxt=msdn%24msdn%24msdn&amp;wreply=http:%2F%2Fmsdn.microsoft.com%2Fen-us%2Flibrary%2Fsystem.net.sockets.socket.aspx&amp;lc=1033&amp;id=254354" ><span id="idPPScarabSIT" class="MTPS_GlobalToolbarLinks_msdn">Sign in</span></a>


			  </div>
			  
			  
		  </div>
		</div>
	</div>
	<div class="classicTopNav">
	    <div class="ThinNavBox">
		<a href="/en-us/default.aspx" id="ctl00_ctl10_brandlink"><div id="ctl00_ctl10_BrandLogo" class="BrandLogo">

</div></a>
		<div class="Search"><div id="ctl00_ctl10_ctl00_SearchBox" class="SearchBox">
    <input name="ctl00$ctl10$ctl00$SearchTextBox" type="text" id="ctl00_ctl10_ctl00_SearchTextBox" title="Search MSDN" class="TextBoxSearch" />
    <input type="image" name="ctl00$ctl10$ctl00$SearchButton" id="ctl00_ctl10_ctl00_SearchButton" title="Click here to search" class="SearchButton" alt="Click here to search" src="http://i.msdn.microsoft.com/Global/Images/clear.gif" border="0" />
    <span class="Bing"></span>
<script type="text/javascript" defer="defer" src="http://i1.services.social.microsoft.com/search/Widgets/SearchBox.jss?boxid=ctl00_ctl10_ctl00_SearchTextBox&btnid=ctl00_ctl10_ctl00_SearchButton&brand=MSDN&loc=en-us" id="mscom.srch.searchBox"></script></div></div>
		<div class="evergreenLinks">
	    
      
     
        <a id="ctl00_ctl10_eventlink"><div id="ctl00_ctl10_EventLogo" class="EventLogo">

</div></a>
     </div>
     
       
	</div>
	    <div class="Clear"></div>
        

	<div class="NavigationBox">
	    <div id="ctl00_ctl10_tabs_CenterTitle" class="HeaderTitle">Microsoft Developer Network</div>
		<div class="Sponsor">
		  
		</div>
		<div class="ClearLeft"></div>
        <div class="leftcap"></div>
        <div class="internav">
	        <div id="ctl00_ctl10_tabs_manTabsHolder"><a id="ctl00_ctl10_tabs_ctl01" href="http://msdn.microsoft.com/en-us/default.aspx" onclick="javascript:Track('|TabStrip Link|ctl00_ctl10_tabs_ctl00|ctl00_ctl10_tabs_ctl01',this);">Home</a><a id="ctl00_ctl10_tabs_ctl03" class="active" href="http://msdn.microsoft.com/en-us/library/default.aspx" onclick="javascript:Track('|TabStrip Link|ctl00_ctl10_tabs_ctl02|ctl00_ctl10_tabs_ctl03',this);">Library</a><a id="ctl00_ctl10_tabs_ctl05" href="http://msdn.microsoft.com/en-us/bb188199.aspx" onclick="javascript:Track('|TabStrip Link|ctl00_ctl10_tabs_ctl04|ctl00_ctl10_tabs_ctl05',this);">Learn</a><a id="ctl00_ctl10_tabs_ctl07" href="http://msdn.microsoft.com/en-us/aa570309.aspx" onclick="javascript:Track('|TabStrip Link|ctl00_ctl10_tabs_ctl06|ctl00_ctl10_tabs_ctl07',this);">Downloads</a><a id="ctl00_ctl10_tabs_ctl09" href="http://msdn.microsoft.com/en-us/aa570318.aspx" onclick="javascript:Track('|TabStrip Link|ctl00_ctl10_tabs_ctl08|ctl00_ctl10_tabs_ctl09',this);">Support</a><a id="ctl00_ctl10_tabs_ctl11" href="http://msdn.microsoft.com/en-us/aa497440.aspx" onclick="javascript:Track('|TabStrip Link|ctl00_ctl10_tabs_ctl10|ctl00_ctl10_tabs_ctl11',this);">Community</a><a id="ctl00_ctl10_tabs_ctl13" href="http://social.msdn.microsoft.com/Forums/en-US/categories" onclick="javascript:Track('|TabStrip Link|ctl00_ctl10_tabs_ctl12|ctl00_ctl10_tabs_ctl13',this);">Forums</a></div>
        </div>
        

<div id="ctl00_ctl10_tabs_LwViewSwitcher1_Panel1" class="LWVS_Loband">
	
<a id="ctl00_ctl10_tabs_LwViewSwitcher1_ClassicLink" tabindex="201" class="LWVS_DisabledLink" onclick="SetViewCookie('classic')">Classic</a>&nbsp | &nbsp <a href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.aspx" id="ctl00_ctl10_tabs_LwViewSwitcher1_LightweightLink" tabindex="202" class="LWVS_Link" onclick="SetViewCookie('lightweight')">Lightweight Beta</a>&nbsp | &nbsp <a href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.aspx" id="ctl00_ctl10_tabs_LwViewSwitcher1_LobandLink" tabindex="203" class="LWVS_Link" onclick="SetViewCookie('loband')">ScriptFree</a>
</div>


        <div class="rightcap"></div>
	</div>
	
	<div class="Clear"></div>
	<div id="ctl00_ctl10_tabs_LocalNavigation" class="LocalNavigation" style="height:2px;">
	    
	</div>
	<div class="cleartabstrip"></div>
	<div id="ctl00_ctl10_tabs_LocalNavBottom" class="LocalNavBottom"></div>
	
	
	
    </div>
</div>
<div class="Clear"></div>    
    <div id="ctl00_ib1_Panel1" class="miniRatings">
	
<div id="ctl00_ib1_miniRatings_left" class="miniRatings_left">
		
    <a id="ctl00_ib1_hlPrint" title="Print This Content" class="itPrint" onclick="javascript:SubmitRateAction('printerFriendlyPage');" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket(printer).aspx"><img id="ctl00_ib1_imgPrint" class="LibC_rtg_print" src="http://i.msdn.microsoft.com/Global/Images/clear.gif" border="0" />&nbsp;Printer Friendly Version</a>&nbsp;&nbsp;
    &nbsp;&nbsp;
    <a id="ctl00_ib1_hlSendCont" title="Send This Content" class="itSend" onclick="javascript:SubmitRateAction('sendThisPage');" href="mailto:?subject=Socket Class (System.Net.Sockets)&amp;body=This URL points to a page on MSDN that may interest you: http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.aspx"><img id="ctl00_ib1_imgSendCont" class="LibC_rtg_email" src="http://i.msdn.microsoft.com/Global/Images/clear.gif" border="0" />&nbsp;Send</a>&nbsp;&nbsp;
    <a id="ctl00_ib1_hlComCon" title="Click here to jump to the Community Content section on this page." class="itComCon" href="/en-us/library/system.net.sockets.socket.aspx#CommunityContent"><img id="ctl00_ib1_imgComCon" class="LibC_rtg_comCon" src="http://i.msdn.microsoft.com/Global/Images/clear.gif" border="0" />&nbsp;Community Content</a>&nbsp;&nbsp;
   
	</div>
<div id="ctl00_ib1_miniRatings_right" class="miniRatings_right">
		
        <div class="ratingFlyoutStatic" style="position:relative;" id="ctl00_ib1_Flyout"><div id="ctl00_ib1_Flyout_rtgContainer" title="Turn scripting on  to submit a rating and send feedback." style="display: block; text-align:right;">
				
              <table>
                <tr>
                  <td style="text-align:right;line-height:70%;">
                    <span id="ctl00_ib1_Flyout_rateTitleLabel" class="tbFont">Click to Rate and Give Feedback</span>
                  </td>
                  <td id="ctl00_ib1_Flyout_tdRtg" style="width:85px" onclick="if($get('ctl00_ib1_Flyout_tbComments')!=null &amp;&amp; $get('ctl00_ib1_Flyout_tbComments').visible == 'true') $get('ctl00_ib1_Flyout_tbComments').focus();">
                      <div id="ctl00_ib1_Flyout_Rating1" title="Click a star and provide feedback" dir="ltr">
					<a href="#" id="ctl00_ib1_Flyout_Rating1_A" title="Click a star and provide feedback" style="text-decoration:none"><span id="ctl00_ib1_Flyout_Rating1_Star_1" class="ratingStar filledRatingStar">&nbsp;</span><span id="ctl00_ib1_Flyout_Rating1_Star_2" class="ratingStar filledRatingStar">&nbsp;</span><span id="ctl00_ib1_Flyout_Rating1_Star_3" class="ratingStar filledRatingStar">&nbsp;</span><span id="ctl00_ib1_Flyout_Rating1_Star_4" class="ratingStar filledRatingStar">&nbsp;</span><span id="ctl00_ib1_Flyout_Rating1_Star_5" class="ratingStar emptyRatingStar">&nbsp;</span></a>
				</div>
                  </td>
				
                </tr>
              </table>
            
			</div>
            <div style="display: block; float: none; clear: both;">
            </div>
          <div id="ctl00_ib1_Flyout_Popup" class="ratingFlyoutPopup" style="position: absolute;visibility:hidden;left:-1000px;">
				<span id="ctl00_ib1_Flyout_lbOptText" class="OptionalText">Give feedback on this content</span><textarea name="ctl00$ib1$Flyout$tbComments" rows="2" cols="20" id="ctl00_ib1_Flyout_tbComments" class="Comment"></textarea><input name="ctl00$ib1$Flyout$btnClose" type="button" id="ctl00_ib1_Flyout_btnClose" Class="Button" value="Close" OnClick="CloseFLY(&quot;ctl00_ib1_Flyout&quot;) " /><input name="ctl00$ib1$Flyout$btnSend" type="button" id="ctl00_ib1_Flyout_btnSend" Class="Button" value="Send" OnClick="return IsPageRated(&quot;ctl00_ib1_Flyout_Rating1&quot;,&quot;ctl00_ib1_Flyout_lbOptText&quot;,'Please rate the page first.', &quot;ctl00_ib1_Flyout&quot;,this)" /></div><div id="ctl00_ib1_Flyout_Anim" class="TFlyPopupAnimate"></div>
		</div>
		
      
	</div>
    
  <div id="intercleardiv" style="display: block; clear: both; visibility: hidden;"></div>

</div>

  </div>
  <div id="contents">
   <div id="ctl00_LibFrame" class="resizableArea">
	<div id="ctl00_raLeft" class="leftSection" style="width:300px;">
		
        <img id="ctl00_TocVector1_o" class="hidden" src="http://i.msdn.microsoft.com/Global/Images/clear.gif" border="0" />
<img id="ctl00_TocVector1_c" class="hidden" src="http://i.msdn.microsoft.com/Global/Images/clear.gif" border="0" />
<img id="ctl00_TocVector1_e" class="hidden" src="http://i.msdn.microsoft.com/Global/Images/clear.gif" border="0" />
<div id="holder" onclick="TocClick(event)">
<div id="ctl00_TocVector1_root" class="rootToc">
			<ul class="toc" id="tocVectorTreeId"><li name="ms310241(n)"><img src="http://i.msdn.microsoft.com/Global/Images/clear.gif" class="LibC_c"/><a href="http://msdn.microsoft.com/en-us/library/ms123401.aspx" target="_top">MSDN Library</a></li></ul>
		</div>
</div>


      
	</div><div id="ctl00_raSplitter" title="Click and drag to resize. Double click or press 't' to toggle visibility." class="splitter" style="left:300px;">
		<div class="LibC_lib_grippy" style="position:absolute;top:50%;"></div>
	</div><div id="ctl00_raRight" class="rightSection">
		
        <div >
          <div id="ctl00_eb1_Panel1" class="EyebrowMenuBar">
			
<div class="stat" style="position:relative;" id="ctl00_eb1_ctl00"><a title="MSDN" href="http://msdn.microsoft.com/en-us/ms348103.aspx">MSDN</a><div id="ctl00_eb1_ctl00_Popup" class="popup" style="position: absolute;visibility:hidden;left:-1000px;">
					<span name="http://msdn.microsoft.com/en-us/library/36cf08ac-18d1-4fe0-abc8-466852a0f9c7(n).aspx">Please Wait</span></div><div id="ctl00_eb1_ctl00_Anim" class="TFlyPopupAnimate"></div>
			</div>
			<div class="stat" style="position:relative;" id="ctl00_eb1_ctl01"><a title="MSDN Library" href="http://msdn.microsoft.com/en-us/library/ms123401.aspx">MSDN Library</a><div id="ctl00_eb1_ctl01_Popup" class="popup" style="position: absolute;visibility:hidden;left:-1000px;">
					<span name="http://msdn.microsoft.com/en-us/library/ms310241(n).aspx">Please Wait</span></div><div id="ctl00_eb1_ctl01_Anim" class="TFlyPopupAnimate"></div>
			</div>
			<div class="stat" style="position:relative;" id="ctl00_eb1_ctl02"><a title=".NET Development" href="http://msdn.microsoft.com/en-us/library/ff361664(VS.100).aspx">.NET Development</a><div id="ctl00_eb1_ctl02_Popup" class="popup" style="position: absolute;visibility:hidden;left:-1000px;">
					<span name="http://msdn.microsoft.com/en-us/library/aa139615(n).aspx">Please Wait</span></div><div id="ctl00_eb1_ctl02_Anim" class="TFlyPopupAnimate"></div>
			</div>
			<div class="stat" style="position:relative;" id="ctl00_eb1_ctl03"><a title=".NET Framework 3.5" href="http://msdn.microsoft.com/en-us/library/w0x726c2.aspx">.NET Framework 3.5</a><div id="ctl00_eb1_ctl03_Popup" class="popup" style="position: absolute;visibility:hidden;left:-1000px;">
					<span name="http://msdn.microsoft.com/en-us/library/bb400859(n).aspx">Please Wait</span></div><div id="ctl00_eb1_ctl03_Anim" class="TFlyPopupAnimate"></div>
			</div>
			<div class="stat" style="position:relative;" id="ctl00_eb1_ctl04"><a title=".NET Framework Class Library" href="http://msdn.microsoft.com/en-us/library/ms229335.aspx">.NET Framework Class Library</a><div id="ctl00_eb1_ctl04_Popup" class="popup" style="position: absolute;visibility:hidden;left:-1000px;">
					<span name="http://msdn.microsoft.com/en-us/library/bb962012(n).aspx">Please Wait</span></div><div id="ctl00_eb1_ctl04_Anim" class="TFlyPopupAnimate"></div>
			</div>
			<div class="stat" style="position:relative;" id="ctl00_eb1_ctl05"><a title="System.Net.Sockets Namespace" href="http://msdn.microsoft.com/en-us/library/sb27wehh.aspx">System.Net.Sockets Namespace</a><div id="ctl00_eb1_ctl05_Popup" class="popup" style="position: absolute;visibility:hidden;left:-1000px;">
					<span name="http://msdn.microsoft.com/en-us/library/cc688928(n).aspx">Please Wait</span></div><div id="ctl00_eb1_ctl05_Anim" class="TFlyPopupAnimate"></div>
			</div>
			<div class="stat" style="position:relative;" id="ctl00_eb1_ctl06"><a title="Socket Class" href="http://msdn.microsoft.com/en-us/library/attbb8f5.aspx">Socket Class</a><div id="ctl00_eb1_ctl06_Popup" class="popup" style="position: absolute;visibility:hidden;left:-1000px;">
					<span name="http://msdn.microsoft.com/en-us/library/cc688965(n).aspx">Please Wait</span></div><div id="ctl00_eb1_ctl06_Anim" class="TFlyPopupAnimate"></div>
			</div>
			<span style="float:none;clear:both;display:block;"></span>
		</div>

        </div>
        

        <div class="RightPanel">
          <div class="ContentBar">
            
<div id="ECDiv" class="ECPanel">
<img id="ECImg" class="LibC_o" src="http://i.msdn.microsoft.com/Global/Images/clear.gif" alt="Collapse All/Expand All" align="middle" style="border-width:0px;" />
<span id="ECCollapse" class="ECLink" >Collapse All</span>
<span id="ECExpand" class="ECLink" style="display:none">Expand All</span>
</div>


            
<script type="text/Javascript">
var visualbasic = new Array(3);
visualbasic[0] = "ctl00_MTCS_main_ctl79_ctl00_ctl00_VisualBasic";
visualbasic[1] = "ctl00_MTCS_main_ctl77_ctl00_ctl01_VisualBasicUsage";
visualbasic[2] = "ctl00_MTCS_main_ctl77_ctl00_ctl00_VisualBasicDeclaration";
var csharp = new Array(2);
csharp[0] = "ctl00_MTCS_main_ctl77_ctl00_ctl02_CSharp";
csharp[1] = "ctl00_MTCS_main_ctl79_ctl00_ctl01_CSharp";
var managedcplusplus = new Array(2);
managedcplusplus[0] = "ctl00_MTCS_main_ctl77_ctl00_ctl03_ManagedCPlusPlus";
managedcplusplus[1] = "ctl00_MTCS_main_ctl79_ctl00_ctl02_ManagedCPlusPlus";
var jscript = new Array(1);
jscript[0] = "ctl00_MTCS_main_ctl77_ctl00_ctl04_JScript";
</script>

<style type="text/css">
.vb, .cs, .cpp, .nu, .fs
{
	display:none;
}
</style>
<style id="LanguageSpecificTextStyle" type="text/css">
.nu
{
   display:inline;
}
</style><div id="ctl00_DropDownFilter_DropDownFilterMain" class="DropDownFilterStyle"><img id="ctl00_DropDownFilter_MTPS_DD_ImageArrow" title="Language Filter" class="MTPS_DropDownImage LibC_arrow-off" onclick="DDFilterOn(event);" onmouseover="ChangeDropDownImage(true);ResetLanguagesMenuTimer(event);" onmouseout="ChangeDropDownImage(false);RequestHideLanguagesMenu();" src="http://i.msdn.microsoft.com/Global/Images/clear.gif" alt="Language Filter" border="0" /><a id="ctl00_DropDownFilter_Mtps_DropDownFilterText" title="Language Filter" class="DropDownFilterOff" onclick="DDFilterOn(event);" onmouseover="ChangeDropDownImage(true);" onmouseout="ChangeDropDownImage(false);" href="/en-us/library/system.net.sockets.socket.aspx#Mtps_DropDownFilterText">Language Filter</a><div id="ctl00_DropDownFilter_Mtps_DropDownPopUp" style="display:none" class="MTPS_PopupDivPanel" onmouseover="ResetLanguagesMenuTimer(event);" onmouseout="RequestHideLanguagesMenu();"><div class="DivCbxLabelLanguage">
			<input name="ctl00$DropDownFilter$DropDownLngFilterCtrl" type="checkbox" id="ctl00_DropDownFilter_DropDownLngFilterCtrl" checked="checked" value="Visual Basic" arrayValue="visualbasic" onclick="SetLangFilter('visualbasic',true);" /><span id="ctl00_DropDownFilter_ctl00_DropDownFilter_DropDownLngFilterCtrl_0" title="Visual Basic">Visual Basic<br/></span>
		</div><div class="DivCbxLabelLanguage">
			<input name="ctl00$DropDownFilter$DropDownLngFilterCtrl" type="checkbox" id="ctl00_DropDownFilter_DropDownLngFilterCtrl" checked="checked" value="C#" arrayValue="csharp" onclick="SetLangFilter('csharp',true);" /><span id="ctl00_DropDownFilter_ctl00_DropDownFilter_DropDownLngFilterCtrl_1" title="C#">C#<br/></span>
		</div><div class="DivCbxLabelLanguage">
			<input name="ctl00$DropDownFilter$DropDownLngFilterCtrl" type="checkbox" id="ctl00_DropDownFilter_DropDownLngFilterCtrl" checked="checked" value="C++" arrayValue="managedcplusplus" onclick="SetLangFilter('managedcplusplus',true);" /><span id="ctl00_DropDownFilter_ctl00_DropDownFilter_DropDownLngFilterCtrl_2" title="C++">C++<br/></span>
		</div><div class="DivCbxLabelLanguage">
			<input name="ctl00$DropDownFilter$DropDownLngFilterCtrl" type="checkbox" id="ctl00_DropDownFilter_DropDownLngFilterCtrl" checked="checked" value="J#" arrayValue="jsharp" onclick="SetLangFilter(null,true);" /><span id="ctl00_DropDownFilter_ctl00_DropDownFilter_DropDownLngFilterCtrl_3" title="J#">J#<br/></span>
		</div><div class="DivCbxLabelLanguage">
			<input name="ctl00$DropDownFilter$DropDownLngFilterCtrl" type="checkbox" id="ctl00_DropDownFilter_DropDownLngFilterCtrl" checked="checked" value="JScript" arrayValue="jscript" onclick="SetLangFilter('jscript',true);" /><span id="ctl00_DropDownFilter_ctl00_DropDownFilter_DropDownLngFilterCtrl_4" title="JScript">JScript<br/></span>
		</div><div class="DivCbxLabelLanguage">
			<input name="ctl00$DropDownFilter$DropDownLngFilterCtrl" type="checkbox" id="ctl00_DropDownFilter_DropDownLngFilterCtrl" checked="checked" value="XAML" arrayValue="xaml" onclick="SetLangFilter(null,true);" /><span id="ctl00_DropDownFilter_ctl00_DropDownFilter_DropDownLngFilterCtrl_5" title="XAML">XAML<br/></span>
		</div><div class="DivCbxLabelLanguage">
			<input name="ctl00$DropDownFilter$DropDownLngFilterCtrl" type="checkbox" id="ctl00_DropDownFilter_DropDownLngFilterCtrl" checked="checked" value="F#" arrayValue="fsharp" onclick="SetLangFilter(null,true);" /><span id="ctl00_DropDownFilter_ctl00_DropDownFilter_DropDownLngFilterCtrl_6" title="F#">F#<br/></span>
		</div></div>
<script type="text/Javascript">
var strConstLangFilterAll ="All";
var strConstLangFilterMulti ="Multiple";
var strConstLangFilterNone ="None";
var strConstLangFilterText ="Language Filter";
var oMTPS_DD_ImgArrow = document.getElementById("ctl00_DropDownFilter_MTPS_DD_ImageArrow");
var oMTPS_DD_PanelLink = document.getElementById("ctl00_DropDownFilter_Mtps_DropDownFilterText");
var oMTPS_DD_Div = document.getElementById("ctl00_DropDownFilter_DropDownFilterMain");
var oMTPS_DD_PopUpDiv = document.getElementById("ctl00_DropDownFilter_Mtps_DropDownPopUp");
</script>
</div>
              
            
            
          </div>
           <div class="ContentArea">
      
          
          <span id="ctl00_altSelector"><div class="AlterPart">
			<div>
				This page is specific to
  
			</div><span>Microsoft Visual Studio 2008/.NET Framework 3.5</span><br/><br/><div>
				Other versions are also available for the following:
  
			</div><div id="ctl00_ctl04">
				<ul><li><a id="ctl00_ctl05" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket(VS.71).aspx" onclick="javascript:Track('ctl00_ctl04|ctl00_ctl05',this);">Microsoft Visual Studio 2003/.NET Framework 1.1</a></li><li><a id="ctl00_ctl06" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket(VS.80).aspx" onclick="javascript:Track('ctl00_ctl04|ctl00_ctl06',this);">Microsoft Visual Studio 2005/.NET Framework 2.0</a></li><li><a id="ctl00_ctl07" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket(VS.85).aspx" onclick="javascript:Track('ctl00_ctl04|ctl00_ctl07',this);">.NET Framework 3.0</a></li><li><a id="ctl00_ctl08" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket(VS.95).aspx" onclick="javascript:Track('ctl00_ctl04|ctl00_ctl08',this);">Microsoft Silverlight 3</a></li><li><a id="ctl00_ctl09" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket(VS.100).aspx" onclick="javascript:Track('ctl00_ctl04|ctl00_ctl09',this);">Microsoft Visual Studio 2010/.NET Framework 4</a></li></ul>
			</div>
		</div></span>
          
          
          
        
          <!--starting processing--><div class="topic" ><div class="majorTitle">.NET Framework Class Library<!----></div><div class="title">Socket Class<!----></div><!--Content type: Devdiv1. Transform: orcas2mtps.xslt.--><div id="mainSection">
      <div id="mainBody">
        
        
        <p><!----></p> <div><div class="summary"><p>Implements the Berkeley sockets interface.</p></div></div><p><!----></p>
    <strong>Namespace:</strong> 
   <a id="ctl00_MTCS_main_ctl02" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl00|ctl00_MTCS_main_ctl02',this);">System.Net.Sockets</a><br />
    <strong>Assembly:</strong>
   <span>System</span> (in System.dll)<span>
<div  class="MTPS_CollapsibleRegion">
<div  class="CollapseRegionLink"> <!-- ApplyClick with current id -->
<img  class='LibC_o' src="http://i.msdn.microsoft.com/Global/Images/clear.gif" style='border-width:0px;vertical-align:middle;' />
&nbsp;Syntax
</div>
<div class="MTPS_CollapsibleSection" style='display:block;' >  
<a id="syntaxToggle"><!----></a><span id="ctl00_MTCS_main_ctl77_ctl00_ctl00">
<div class='libCScode'
id="ctl00_MTCS_main_ctl77_ctl00_ctl00_VisualBasicDeclaration">
    
    <div class="CodeSnippetTitleBar">
        <div class="CodeDisplayLanguage">
            Visual Basic (Declaration)
        </div>
        
    </div>
    <div dir="ltr" style="background-color: #ddd">
    <pre class="libCScode" id="ctl00_MTCS_main_ctl77_ctl00_ctl00_code" space="preserve"><span style="color:blue">Public</span> <span style="color:blue">Class</span> Socket _
    <span style="color:blue">Implements</span> IDisposable</pre>
    </div>
</div>

</span><span id="ctl00_MTCS_main_ctl77_ctl00_ctl01">
<div class='libCScode'
id="ctl00_MTCS_main_ctl77_ctl00_ctl01_VisualBasicUsage">
    
    <div class="CodeSnippetTitleBar">
        <div class="CodeDisplayLanguage">
            Visual Basic (Usage)
        </div>
        
    </div>
    <div dir="ltr" style="background-color: #ddd">
    <pre class="libCScode" id="ctl00_MTCS_main_ctl77_ctl00_ctl01_code" space="preserve"><span style="color:blue">Dim</span> instance <span style="color:blue">As</span> Socket</pre>
    </div>
</div>

</span><span id="ctl00_MTCS_main_ctl77_ctl00_ctl02">
<div class='libCScode'
id="ctl00_MTCS_main_ctl77_ctl00_ctl02_CSharp">
    
    <div class="CodeSnippetTitleBar">
        <div class="CodeDisplayLanguage">
            C#
        </div>
        
    </div>
    <div dir="ltr" style="background-color: #ddd">
    <pre class="libCScode" id="ctl00_MTCS_main_ctl77_ctl00_ctl02_code" space="preserve"><span style="color:blue">public</span> <span style="color:blue">class</span> Socket : IDisposable</pre>
    </div>
</div>

</span><span id="ctl00_MTCS_main_ctl77_ctl00_ctl03">
<div class='libCScode'
id="ctl00_MTCS_main_ctl77_ctl00_ctl03_ManagedCPlusPlus">
    
    <div class="CodeSnippetTitleBar">
        <div class="CodeDisplayLanguage">
            Visual C++
        </div>
        
    </div>
    <div dir="ltr" style="background-color: #ddd">
    <pre class="libCScode" id="ctl00_MTCS_main_ctl77_ctl00_ctl03_code" space="preserve"><span style="color:blue">public</span> ref <span style="color:blue">class</span> Socket : IDisposable</pre>
    </div>
</div>

</span><span id="ctl00_MTCS_main_ctl77_ctl00_ctl04">
<div class='libCScode'
id="ctl00_MTCS_main_ctl77_ctl00_ctl04_JScript">
    
    <div class="CodeSnippetTitleBar">
        <div class="CodeDisplayLanguage">
            JScript
        </div>
        
    </div>
    <div dir="ltr" style="background-color: #ddd">
    <pre class="libCScode" id="ctl00_MTCS_main_ctl77_ctl00_ctl04_code" space="preserve"><span style="color:blue">public</span> <span style="color:blue">class</span> Socket implements IDisposable</pre>
    </div>
</div>

</span>
</div>
</div>
</span><span>
<div  class="MTPS_CollapsibleRegion">
<div  class="CollapseRegionLink"> <!-- ApplyClick with current id -->
<img  class='LibC_o' src="http://i.msdn.microsoft.com/Global/Images/clear.gif" style='border-width:0px;vertical-align:middle;' />
&nbsp;Remarks
</div>
<div class="MTPS_CollapsibleSection" style='display:block;' >  
<a id="remarksToggle"><!----></a><p>The <span><span class="selflink">Socket</span></span> class provides a rich set of methods and properties for network communications. The <span><span class="selflink">Socket</span></span> class allows you to perform both synchronous and asynchronous data transfer using any of the communication protocols listed in the <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl00" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.protocoltype.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl00',this);">ProtocolType</a></span> enumeration. </p><p>The <span><span class="selflink">Socket</span></span> class follows the .NET Framework naming pattern for asynchronous methods. For example, the synchronous <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl01" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.receive.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl01',this);">Receive</a></span> method corresponds to the asynchronous <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl02" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.beginreceive.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl02',this);">BeginReceive</a></span> and <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl03" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.endreceive.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl03',this);">EndReceive</a></span> methods.</p><p>If your application only requires one thread during execution, use the following methods, which are designed for synchronous operation mode.</p><ul><li><p>If you are using a connection-oriented protocol such as TCP, your server can listen for connections using the <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl04" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.listen.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl04',this);">Listen</a></span> method. The <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl05" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.accept.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl05',this);">Accept</a></span> method processes any incoming connection requests and returns a <span><span class="selflink">Socket</span></span> that you can use to communicate data with the remote host. Use this returned <span><span class="selflink">Socket</span></span> to call the <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl06" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.send.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl06',this);">Send</a></span> or <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl07" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.receive.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl07',this);">Receive</a></span> method. Call the <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl08" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.bind.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl08',this);">Bind</a></span> method prior to calling the <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl09" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.listen.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl09',this);">Listen</a></span> method if you want to specify the local IP address and port number. Use a port number of zero if you want the underlying service provider to assign a free port for you. If you want to connect to a listening host, call the <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl10" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.connect.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl10',this);">Connect</a></span> method. To communicate data, call the <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl11" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.send.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl11',this);">Send</a></span> or <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl12" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.receive.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl12',this);">Receive</a></span> method.</p></li><li><p>If you are using a connectionless protocol such as UDP, you do not need to listen for connections at all. Call the <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl13" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.receivefrom.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl13',this);">ReceiveFrom</a></span> method to accept any incoming datagrams. Use the <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl14" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.sendto.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl14',this);">SendTo</a></span> method to send datagrams to a remote host.</p></li></ul><p>To process communications using separate threads during execution, use the following methods, which are designed for asynchronous operation mode.</p><ul><li><p>If you are using a connection-oriented protocol such as TCP, use the <span><span class="selflink">Socket</span></span>, <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl15" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.beginconnect.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl15',this);">BeginConnect</a></span>, and <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl16" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.endconnect.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl16',this);">EndConnect</a></span> methods to connect with a listening host. Use the <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl17" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.beginsend.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl17',this);">BeginSend</a></span> and <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl18" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.endsend.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl18',this);">EndSend</a></span> or <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl19" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.beginreceive.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl19',this);">BeginReceive</a></span> and <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl20" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.endreceive.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl20',this);">EndReceive</a></span> methods to communicate data asynchronously. Incoming connection requests can be processed using <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl21" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.beginaccept.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl21',this);">BeginAccept</a></span> and <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl22" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.endaccept.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl22',this);">EndAccept</a></span>.</p></li><li><p>If you are using a connectionless protocol such as UDP, you can use <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl23" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.beginsendto.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl23',this);">BeginSendTo</a></span> and <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl24" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.endsendto.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl24',this);">EndSendTo</a></span> to send datagrams, and <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl25" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.beginreceivefrom.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl25',this);">BeginReceiveFrom</a></span> and <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl26" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.endreceivefrom.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl26',this);">EndReceiveFrom</a></span> to receive datagrams.</p></li></ul><p>If you perform multiple asynchronous operations on a socket, they do not necessarily complete in the order in which they are started.</p><p>When you are finished sending and receiving data, use the <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl27" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.shutdown.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl27',this);">Shutdown</a></span> method to disable the <span><span class="selflink">Socket</span></span>. After calling <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl28" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.shutdown.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl28',this);">Shutdown</a></span>, call the <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl29" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.close.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl29',this);">Close</a></span> method to release all resources associated with the <span><span class="selflink">Socket</span></span>.</p><p>The <span><span class="selflink">Socket</span></span> class allows you to configure your <span><span class="selflink">Socket</span></span> using the <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl30" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.setsocketoption.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl30',this);">SetSocketOption</a></span> method. Retrieve these settings using the <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl31" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.getsocketoption.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl31',this);">GetSocketOption</a></span> method.</p><div class="alert"><table><tr><th><!--src=[../icons/alert_note.gif]--><img alt="Note" src="http://i.msdn.microsoft.com/attbb8f5.alert_note(en-us,VS.90).gif" /><strong>Note:</strong></th></tr><tr><td><p>If you are writing a relatively simple application and do not require maximum performance, consider using <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl33" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.tcpclient.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl33',this);">TcpClient</a></span>, <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl34" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.tcplistener.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl34',this);">TcpListener</a></span>, and <span><a id="ctl00_MTCS_main_ctl78_ctl00_ctl35" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.udpclient.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl78_ctl00_contenthere|ctl00_MTCS_main_ctl78_ctl00_ctl35',this);">UdpClient</a></span>. These classes provide a simpler and more user-friendly interface to <span><span class="selflink">Socket</span></span> communications.</p></td></tr></table></div><p>
	  <strong>Windows Mobile for Pocket PC, Windows Mobile for Smartphone, Windows CE Platform Note:</strong> Not all socket options are supported on all device operating systems. 
  </p><span IndexMoniker="!DefaultDynamicLinkIndex" errorURL="" filterName="" filterString=""></span>
</div>
</div>
</span><span>
<div  class="MTPS_CollapsibleRegion">
<div  class="CollapseRegionLink"> <!-- ApplyClick with current id -->
<img  class='LibC_o' src="http://i.msdn.microsoft.com/Global/Images/clear.gif" style='border-width:0px;vertical-align:middle;' />
&nbsp;Examples
</div>
<div class="MTPS_CollapsibleSection" style='display:block;' >  
<a id="exampleToggle"><!----></a><p>The following code example shows how the <span><span class="selflink">Socket</span></span> class can be used to send data to an HTTP server and receive the response. This example blocks until the entire page is received.</p><div id="snippetGroup"><span id="ctl00_MTCS_main_ctl79_ctl00_ctl00">
<div class='libCScode'
id="ctl00_MTCS_main_ctl79_ctl00_ctl00_VisualBasic">
    
    <div class="CodeSnippetTitleBar">
        <div class="CodeDisplayLanguage">
            Visual Basic
        </div>
        
    </div>
    <div dir="ltr" style="background-color: #ddd">
    <pre class="libCScode" id="ctl00_MTCS_main_ctl79_ctl00_ctl00_code" space="preserve"><span style="color:blue">Imports</span> System
<span style="color:blue">Imports</span> System.Text
<span style="color:blue">Imports</span> System.IO
<span style="color:blue">Imports</span> System.Net
<span style="color:blue">Imports</span> System.Net.Sockets
<span style="color:blue">Imports</span> Microsoft.VisualBasic

<span style="color:blue">Public</span> <span style="color:blue">Class</span> GetSocket

   <span style="color:blue">Private</span> <span style="color:blue">Shared</span> <span style="color:blue">Function</span> ConnectSocket(server <span style="color:blue">As</span> <span style="color:blue">String</span>, port <span style="color:blue">As</span> <span style="color:blue">Integer</span>) <span style="color:blue">As</span> Socket
      <span style="color:blue">Dim</span> s <span style="color:blue">As</span> Socket = <span style="color:blue">Nothing</span>
      <span style="color:blue">Dim</span> hostEntry <span style="color:blue">As</span> IPHostEntry = <span style="color:blue">Nothing</span>      

         <span style="color:green">' Get host related information.</span>
        hostEntry = Dns.GetHostEntry(server)

         <span style="color:green">' Loop through the AddressList to obtain the supported AddressFamily. This is to avoid</span>
         <span style="color:green">' an exception that occurs when the host host IP Address is not compatible with the address family</span>
         <span style="color:green">' (typical in the IPv6 case).</span>
      <span style="color:blue">Dim</span> address <span style="color:blue">As</span> IPAddress

        <span style="color:blue">For</span> <span style="color:blue">Each</span> address <span style="color:blue">In</span>  hostEntry.AddressList
            <span style="color:blue">Dim</span> endPoint <span style="color:blue">As</span> <span style="color:blue">New</span> IPEndPoint(address, port)
            <span style="color:blue">Dim</span> tempSocket <span style="color:blue">As</span> <span style="color:blue">New</span> Socket(endPoint.AddressFamily, SocketType.Stream, ProtocolType.Tcp)

            tempSocket.Connect(endPoint)

            <span style="color:blue">If</span> tempSocket.Connected <span style="color:blue">Then</span>
               s = tempSocket
               <span style="color:blue">Exit</span> <span style="color:blue">For</span>
            <span style="color:blue">End</span> <span style="color:blue">If</span>

         <span style="color:blue">Next</span> address

      <span style="color:blue">Return</span> s
   <span style="color:blue">End</span> <span style="color:blue">Function</span> 


   <span style="color:green">' This method requests the home page content for the specified server.</span>

   <span style="color:blue">Private</span> <span style="color:blue">Shared</span> <span style="color:blue">Function</span> SocketSendReceive(server <span style="color:blue">As</span> <span style="color:blue">String</span>, port <span style="color:blue">As</span> <span style="color:blue">Integer</span>) <span style="color:blue">As</span> <span style="color:blue">String</span>
      <span style="color:green">'Set up variables and String to write to the server.</span>
      <span style="color:blue">Dim</span> ascii <span style="color:blue">As</span> Encoding = Encoding.ASCII
      <span style="color:blue">Dim</span> request <span style="color:blue">As</span> <span style="color:blue">String</span> = <span style="color: maroon">&quot;GET / HTTP/1.1&quot;</span> + ControlChars.Cr + ControlChars.Lf + <span style="color: maroon">&quot;Host: &quot;</span> + server + ControlChars.Cr + ControlChars.Lf + <span style="color: maroon">&quot;Connection: Close&quot;</span> + ControlChars.Cr + ControlChars.Lf + ControlChars.Cr + ControlChars.Lf
      <span style="color:blue">Dim</span> bytesSent <span style="color:blue">As</span> [Byte]() = ascii.GetBytes(request)
      <span style="color:blue">Dim</span> bytesReceived(255) <span style="color:blue">As</span> [Byte]

      <span style="color:green">' Create a socket connection with the specified server and port.</span>
      <span style="color:blue">Dim</span> s <span style="color:blue">As</span> Socket = ConnectSocket(server, port)

      <span style="color:blue">If</span> s <span style="color:blue">Is</span> <span style="color:blue">Nothing</span> <span style="color:blue">Then</span>
         <span style="color:blue">Return</span> <span style="color: maroon">&quot;Connection failed&quot;</span>
      <span style="color:blue">End</span> <span style="color:blue">If</span> 
      <span style="color:green">' Send request to the server.</span>
      s.Send(bytesSent, bytesSent.Length, 0)

      <span style="color:green">' Receive the server  home page content.</span>
      <span style="color:blue">Dim</span> bytes <span style="color:blue">As</span> Int32

      <span style="color:green">' Read the first 256 bytes.</span>
      <span style="color:blue">Dim</span> page <span style="color:blue">as</span> [String] = <span style="color: maroon">&quot;Default HTML page on &quot;</span> + server + <span style="color: maroon">&quot;:&quot;</span> + ControlChars.Cr + ControlChars.Lf

      <span style="color:green">' The following will block until the page is transmitted.</span>
      <span style="color:blue">Do</span>
         bytes = s.Receive(bytesReceived, bytesReceived.Length, 0)
            page = page + Encoding.ASCII.GetString(bytesReceived, 0, bytes)
      <span style="color:blue">Loop</span> <span style="color:blue">While</span> bytes &gt; 0

      <span style="color:blue">Return</span> page
   <span style="color:blue">End</span> <span style="color:blue">Function</span> 

   <span style="color:green">'Entry point which delegates to C-style main Private Function</span>
   <span style="color:blue">Public</span> <span style="color:blue">Overloads</span> <span style="color:blue">Shared</span> <span style="color:blue">Sub</span> Main()
      Main(System.Environment.GetCommandLineArgs())
   <span style="color:blue">End</span> <span style="color:blue">Sub</span>


   <span style="color:blue">Overloads</span> <span style="color:blue">Private</span> <span style="color:blue">Shared</span> <span style="color:blue">Sub</span> Main(args() <span style="color:blue">As</span> <span style="color:blue">String</span>)
      <span style="color:blue">Dim</span> host <span style="color:blue">As</span> <span style="color:blue">String</span>
      <span style="color:blue">Dim</span> port <span style="color:blue">As</span> <span style="color:blue">Integer</span> = 80

      <span style="color:blue">If</span> args.Length = 1 <span style="color:blue">Then</span>
         <span style="color:green">' If no server name is passed as argument to this program, </span>
         <span style="color:green">' use the current host name as default.</span>
         host = Dns.GetHostName()
      <span style="color:blue">Else</span>
         host = args(1)
      <span style="color:blue">End</span> <span style="color:blue">If</span> 

      <span style="color:blue">Dim</span> result <span style="color:blue">As</span> <span style="color:blue">String</span> = SocketSendReceive(host, port)

      Console.WriteLine(result)
   <span style="color:blue">End</span> <span style="color:blue">Sub</span> <span style="color:green">'Main</span>
<span style="color:blue">End</span> <span style="color:blue">Class</span>  

</pre>
    </div>
</div>

</span><span id="ctl00_MTCS_main_ctl79_ctl00_ctl01">
<div class='libCScode'
id="ctl00_MTCS_main_ctl79_ctl00_ctl01_CSharp">
    
    <div class="CodeSnippetTitleBar">
        <div class="CodeDisplayLanguage">
            C#
        </div>
        
    </div>
    <div dir="ltr" style="background-color: #ddd">
    <pre class="libCScode" id="ctl00_MTCS_main_ctl79_ctl00_ctl01_code" space="preserve"><span style="color:blue">using</span> System;
<span style="color:blue">using</span> System.Text;
<span style="color:blue">using</span> System.IO;
<span style="color:blue">using</span> System.Net;
<span style="color:blue">using</span> System.Net.Sockets;

<span style="color:blue">public</span> <span style="color:blue">class</span> GetSocket
{
    <span style="color:blue">private</span> <span style="color:blue">static</span> Socket ConnectSocket(<span style="color:blue">string</span> server, <span style="color:blue">int</span> port)
    {
        Socket s = <span style="color:blue">null</span>;
        IPHostEntry hostEntry = <span style="color:blue">null</span>;

        <span style="color:green">// Get host related information.</span>
        hostEntry = Dns.GetHostEntry(server);

        <span style="color:green">// Loop through the AddressList to obtain the supported AddressFamily. This is to avoid</span>
        <span style="color:green">// an exception that occurs when the host IP Address is not compatible with the address family</span>
        <span style="color:green">// (typical in the IPv6 case).</span>
        <span style="color:blue">foreach</span>(IPAddress address <span style="color:blue">in</span> hostEntry.AddressList)
        {
            IPEndPoint ipe = <span style="color:blue">new</span> IPEndPoint(address, port);
            Socket tempSocket = 
                <span style="color:blue">new</span> Socket(ipe.AddressFamily, SocketType.Stream, ProtocolType.Tcp);

            tempSocket.Connect(ipe);

            <span style="color:blue">if</span>(tempSocket.Connected)
            {
                s = tempSocket;
                <span style="color:blue">break</span>;
            }
            <span style="color:blue">else</span>
            {
                continue;
            }
        }
        <span style="color:blue">return</span> s;
    }

    <span style="color:green">// This method requests the home page content for the specified server.</span>
    <span style="color:blue">private</span> <span style="color:blue">static</span> <span style="color:blue">string</span> SocketSendReceive(<span style="color:blue">string</span> server, <span style="color:blue">int</span> port) 
    {
        <span style="color:blue">string</span> request = <span style="color: maroon"><span style="color: maroon">&quot;GET / HTTP/1.1\r\nHost: &quot;</span></span> + server + 
            <span style="color: maroon"><span style="color: maroon">&quot;\r\nConnection: Close\r\n\r\n&quot;</span></span>;
        Byte[] bytesSent = Encoding.ASCII.GetBytes(request);
        Byte[] bytesReceived = <span style="color:blue">new</span> Byte[256];

        <span style="color:green">// Create a socket connection with the specified server and port.</span>
        Socket s = ConnectSocket(server, port);

        <span style="color:blue">if</span> (s == <span style="color:blue">null</span>)
            <span style="color:blue">return</span> (<span style="color: maroon"><span style="color: maroon">&quot;Connection failed&quot;</span></span>);

        <span style="color:green">// Send request to the server.</span>
        s.Send(bytesSent, bytesSent.Length, 0);  

        <span style="color:green">// Receive the server home page content.</span>
        <span style="color:blue">int</span> bytes = 0;
        <span style="color:blue">string</span> page = <span style="color: maroon"><span style="color: maroon">&quot;Default HTML page on &quot;</span></span> + server + <span style="color: maroon"><span style="color: maroon">&quot;:\r\n&quot;</span></span>;

        <span style="color:green">// The following will block until te page is transmitted.</span>
        do {
            bytes = s.Receive(bytesReceived, bytesReceived.Length, 0);
            page = page + Encoding.ASCII.GetString(bytesReceived, 0, bytes);
        }
        <span style="color:blue">while</span> (bytes &gt; 0);

        <span style="color:blue">return</span> page;
    }

    <span style="color:blue">public</span> <span style="color:blue">static</span> <span style="color:blue">void</span> Main(<span style="color:blue">string</span>[] args) 
    {
        <span style="color:blue">string</span> host;
        <span style="color:blue">int</span> port = 80;

        <span style="color:blue">if</span> (args.Length == 0)
            <span style="color:green">// If no server name is passed as argument to this program, </span>
            <span style="color:green">// use the current host name as the default.</span>
            host = Dns.GetHostName();
        <span style="color:blue">else</span>
            host = args[0];

        <span style="color:blue">string</span> result = SocketSendReceive(host, port); 
        Console.WriteLine(result);
    }
}

</pre>
    </div>
</div>

</span><span id="ctl00_MTCS_main_ctl79_ctl00_ctl02">
<div class='libCScode'
id="ctl00_MTCS_main_ctl79_ctl00_ctl02_ManagedCPlusPlus">
    
    <div class="CodeSnippetTitleBar">
        <div class="CodeDisplayLanguage">
            Visual C++
        </div>
        
    </div>
    <div dir="ltr" style="background-color: #ddd">
    <pre class="libCScode" id="ctl00_MTCS_main_ctl79_ctl00_ctl02_code" space="preserve">#<span style="color:blue">using</span> &lt;System.dll&gt;

<span style="color:blue">using</span> <span style="color:blue">namespace</span> System;
<span style="color:blue">using</span> <span style="color:blue">namespace</span> System::Text;
<span style="color:blue">using</span> <span style="color:blue">namespace</span> System::IO;
<span style="color:blue">using</span> <span style="color:blue">namespace</span> System::Net;
<span style="color:blue">using</span> <span style="color:blue">namespace</span> System::Net::Sockets;
<span style="color:blue">using</span> <span style="color:blue">namespace</span> System::Collections;
Socket^ ConnectSocket( String^ server, <span style="color:blue">int</span> port )
{
   Socket^ s = nullptr;
   IPHostEntry^ hostEntry = nullptr;

   <span style="color:green">// Get host related information.</span>
   hostEntry = Dns::Resolve( server );

   <span style="color:green">// Loop through the AddressList to obtain the supported AddressFamily. This is to avoid</span>
   <span style="color:green">// an exception that occurs when the host IP Address is not compatible with the address family</span>
   <span style="color:green">// (typical in the IPv6 case).</span>
   IEnumerator^ myEnum = hostEntry-&gt;AddressList-&gt;GetEnumerator();
   <span style="color:blue">while</span> ( myEnum-&gt;MoveNext() )
   {
      IPAddress^ address = safe_cast&lt;IPAddress^&gt;(myEnum-&gt;Current);
      IPEndPoint^ endPoint = gcnew IPEndPoint( address,port );
      Socket^ tmpS = gcnew Socket( endPoint-&gt;AddressFamily,SocketType::Stream,ProtocolType::Tcp );
      tmpS-&gt;Connect( endPoint );
      <span style="color:blue">if</span> ( tmpS-&gt;Connected )
      {
         s = tmpS;
         <span style="color:blue">break</span>;
      }
      <span style="color:blue">else</span>
      {
         continue;
      }
   }

   <span style="color:blue">return</span> s;
}


<span style="color:green">// This method requests the home page content for the specified server.</span>
String^ SocketSendReceive( String^ server, <span style="color:blue">int</span> port )
{
   String^ request = String::Concat( <span style="color: maroon"><span style="color: maroon">&quot;GET / HTTP/1.1\r\nHost: &quot;</span></span>, server, <span style="color: maroon"><span style="color: maroon">&quot;\r\nConnection: Close\r\n\r\n&quot;</span></span> );
   array&lt;Byte&gt;^bytesSent = Encoding::ASCII-&gt;GetBytes( request );
   array&lt;Byte&gt;^bytesReceived = gcnew array&lt;Byte&gt;(256);

   <span style="color:green">// Create a socket connection with the specified server and port.</span>
   Socket^ s = ConnectSocket( server, port );
   <span style="color:blue">if</span> ( s == nullptr )
      <span style="color:blue">return</span> (<span style="color: maroon"><span style="color: maroon">&quot;Connection failed&quot;</span></span>);


   <span style="color:green">// Send request to the server.</span>
   s-&gt;Send( bytesSent, bytesSent-&gt;Length, static_cast&lt;SocketFlags&gt;(0) );

   <span style="color:green">// Receive the server home page content.</span>
   <span style="color:blue">int</span> bytes = 0;
   String^ strRetPage = String::Concat( <span style="color: maroon"><span style="color: maroon">&quot;Default HTML page on &quot;</span></span>, server, <span style="color: maroon"><span style="color: maroon">&quot;:\r\n&quot;</span></span> );
   do
   {
      bytes = s-&gt;Receive( bytesReceived, bytesReceived-&gt;Length, static_cast&lt;SocketFlags&gt;(0) );
      strRetPage = String::Concat( strRetPage, Encoding::ASCII-&gt;GetString( bytesReceived, 0, bytes ) );
   }
   <span style="color:blue">while</span> ( bytes &gt; 0 );

   <span style="color:blue">return</span> strRetPage;
}

<span style="color:blue">int</span> main()
{
   array&lt;String^&gt;^args = Environment::GetCommandLineArgs();
   String^ host;
   <span style="color:blue">int</span> port = 80;
   <span style="color:blue">if</span> ( args-&gt;Length == 1 )

   <span style="color:green">// If no server name is passed as argument to this program, </span>
   <span style="color:green">// use the current host name as default.</span>
   host = Dns::GetHostName();
   <span style="color:blue">else</span>
      host = args[ 1 ];

   String^ result = SocketSendReceive( host, port );
   Console::WriteLine( result );
}

</pre>
    </div>
</div>

</span><span id="ctl00_MTCS_main_ctl79_ctl00_ctl03">
<div class='libCScode'
id="ctl00_MTCS_main_ctl79_ctl00_ctl03_CPP_OLD">
    
    <div class="CodeSnippetTitleBar">
        <div class="CodeDisplayLanguage">
            CPP_OLD
        </div>
        
    </div>
    <div dir="ltr" style="background-color: #ddd">
    <pre class="libCScode" id="ctl00_MTCS_main_ctl79_ctl00_ctl03_code" space="preserve">#using <span style="color:blue">&lt;</span><span style="color: maroon">mscorlib.dll</span><span style="color:blue">&gt;</span>
#using <span style="color:blue">&lt;</span><span style="color: maroon">System.dll</span><span style="color:blue">&gt;</span>
using namespace System;
using namespace System::Text;
using namespace System::IO;
using namespace System::Net;
using namespace System::Net::Sockets;
using namespace System::Collections;

Socket * ConnectSocket(String* server, int port) {
    Socket* s = 0;
    IPHostEntry* hostEntry = 0;

    // Get host related information.
    hostEntry = Dns::Resolve(server);

    // Loop through the AddressList to obtain the supported AddressFamily. This is to avoid
    // an exception that occurs when the host IP Address is not compatible with the address family
    // (typical in the IPv6 case).
    IEnumerator* myEnum = hostEntry-<span style="color:blue">&gt;</span>AddressList-<span style="color:blue">&gt;</span>GetEnumerator();
    while (myEnum-<span style="color:blue">&gt;</span>MoveNext()) 
    {
        IPAddress* address = __try_cast<span style="color:blue">&lt;</span><span style="color: maroon">IPAddress*</span><span style="color:blue">&gt;</span>(myEnum-<span style="color:blue">&gt;</span>Current);
        IPEndPoint* endPoint = new IPEndPoint(address, port);
        Socket* tmpS = new Socket(endPoint-<span style="color:blue">&gt;</span>AddressFamily, SocketType::Stream, ProtocolType::Tcp);
        tmpS-<span style="color:blue">&gt;</span>Connect(endPoint);
        if (tmpS-<span style="color:blue">&gt;</span>Connected) 
        {
            s = tmpS;
            break;
        } else
        {
            continue;
        }
    }

    return s;
}

// This method requests the home page content for the specified server.

String* SocketSendReceive(String* server, int port) 
{
    String* request = String::Concat(S&quot;GET / HTTP/1.1\r\nHost: &quot;, server,
        S&quot;\r\nConnection: Close\r\n\r\n&quot;);
    Byte bytesSent[] = Encoding::ASCII-<span style="color:blue">&gt;</span>GetBytes(request);
    Byte bytesReceived[] = new Byte[256];

    // Create a socket connection with the specified server and port.
    Socket* s = ConnectSocket(server, port);
    if (s == 0)
        return (S&quot;Connection failed&quot;);

    // Send request to the server.
    s-<span style="color:blue">&gt;</span>Send(bytesSent, bytesSent-<span style="color:blue">&gt;</span>Length, static_cast<span style="color:blue">&lt;</span><span style="color: maroon">SocketFlags</span><span style="color:blue">&gt;</span>(0));

    // Receive the server home page content.
    int bytes = 0;
    String* strRetPage = String::Concat(S&quot;Default HTML page on &quot;, server, S&quot;:\r\n&quot;);

    do {
        bytes = s-<span style="color:blue">&gt;</span>Receive(bytesReceived, bytesReceived-<span style="color:blue">&gt;</span>Length, static_cast<span style="color:blue">&lt;</span><span style="color: maroon">SocketFlags</span><span style="color:blue">&gt;</span>(0));
        strRetPage = String::Concat(strRetPage, Encoding::ASCII-<span style="color:blue">&gt;</span>GetString(bytesReceived, 0, bytes));
    }
    while (bytes <span style="color:blue">&gt;</span> 0);

    return strRetPage;
}

int main() {
    String* args[] = Environment::GetCommandLineArgs();
    String* host;
    int port = 80;

    if (args-<span style="color:blue">&gt;</span>Length == 1)
        // If no server name is passed as argument to this program, 
        // use the current host name as default.
        host = Dns::GetHostName();
    else
        host = args[1];

    String* result = SocketSendReceive(host, port);
    Console::WriteLine(result);
}
</pre>
    </div>
</div>

</span></div>
</div>
</div>
</span><span>
<div  class="MTPS_CollapsibleRegion">
<div  class="CollapseRegionLink"> <!-- ApplyClick with current id -->
<img  class='LibC_o' src="http://i.msdn.microsoft.com/Global/Images/clear.gif" style='border-width:0px;vertical-align:middle;' />
&nbsp;.NET Framework Security
</div>
<div class="MTPS_CollapsibleSection" style='display:block;' >  
<a id="permissionsToggle"><!----></a><ul><li><span><a id="ctl00_MTCS_main_ctl80_ctl00_ctl00" href="http://msdn.microsoft.com/en-us/library/system.net.socketpermission.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl80_ctl00_contenthere|ctl00_MTCS_main_ctl80_ctl00_ctl00',this);">SocketPermission</a></span> <p>To establish an outgoing connection or accept an incoming request. </p></li></ul>
</div>
</div>
</span><span>
<div  class="MTPS_CollapsibleRegion">
<div  class="CollapseRegionLink"> <!-- ApplyClick with current id -->
<img  class='LibC_o' src="http://i.msdn.microsoft.com/Global/Images/clear.gif" style='border-width:0px;vertical-align:middle;' />
&nbsp;Inheritance Hierarchy
</div>
<div class="MTPS_CollapsibleSection" style='display:block;' >  
<a id="familyToggle"><!----></a><a id="ctl00_MTCS_main_ctl81_ctl00_ctl00" href="http://msdn.microsoft.com/en-us/library/system.object.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl81_ctl00_contenthere|ctl00_MTCS_main_ctl81_ctl00_ctl00',this);">System<span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span>Object</a><br />  <span class="selflink">System.Net.Sockets<span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span>Socket</span><br />
</div>
</div>
</span><span>
<div  class="MTPS_CollapsibleRegion">
<div  class="CollapseRegionLink"> <!-- ApplyClick with current id -->
<img  class='LibC_o' src="http://i.msdn.microsoft.com/Global/Images/clear.gif" style='border-width:0px;vertical-align:middle;' />
&nbsp;Thread Safety
</div>
<div class="MTPS_CollapsibleSection" style='display:block;' >  
<a id="threadSafetyToggle"><!----></a><p>Instances of this class are thread safe.</p>
</div>
</div>
</span><span>
<div  class="MTPS_CollapsibleRegion">
<div  class="CollapseRegionLink"> <!-- ApplyClick with current id -->
<img  class='LibC_o' src="http://i.msdn.microsoft.com/Global/Images/clear.gif" style='border-width:0px;vertical-align:middle;' />
&nbsp;Platforms
</div>
<div class="MTPS_CollapsibleSection" style='display:block;' >  
<a id="platformsTitleToggle"><!----></a><p>Windows 7, Windows Vista, Windows XP SP2, Windows XP Media Center Edition, Windows XP Professional x64 Edition, Windows XP Starter Edition, Windows Server 2008 R2, Windows Server 2008, Windows Server 2003, Windows Server 2000 SP4, Windows Millennium Edition, Windows 98, Windows CE, Windows Mobile for Smartphone, Windows Mobile for Pocket PC</p><p>
	  </p><p><!----></p>
	  <span>
		  The .NET Framework and .NET Compact Framework do not support all versions of every platform. For a list of the supported versions, see <a id="ctl00_MTCS_main_ctl83_ctl00_ctl00" href="http://msdn.microsoft.com/en-us/library/8z6watww.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl83_ctl00_contenthere|ctl00_MTCS_main_ctl83_ctl00_ctl00',this);">.NET Framework System Requirements</a>.
	  </span>
  
</div>
</div>
</span><span>
<div  class="MTPS_CollapsibleRegion">
<div  class="CollapseRegionLink"> <!-- ApplyClick with current id -->
<img  class='LibC_o' src="http://i.msdn.microsoft.com/Global/Images/clear.gif" style='border-width:0px;vertical-align:middle;' />
&nbsp;Version Information
</div>
<div class="MTPS_CollapsibleSection" style='display:block;' >  
<a id="versionsTitleToggle"><!----></a><h4 class="subHeading">.NET Framework</h4>Supported in: 3.5, 3.0, 2.0, 1.1, 1.0<br /><h4 class="subHeading">.NET Compact Framework</h4>Supported in: 3.5, 2.0, 1.0<br />
</div>
</div>
</span><span>
<div  class="MTPS_CollapsibleRegion">
<div  class="CollapseRegionLink"> <!-- ApplyClick with current id -->
<img  class='LibC_o' src="http://i.msdn.microsoft.com/Global/Images/clear.gif" style='border-width:0px;vertical-align:middle;' />
&nbsp;See Also
</div>
<div class="MTPS_CollapsibleSection" style='display:block;' >  
<a id="seeAlsoToggle"><!----></a><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a id="ctl00_MTCS_main_ctl85_ctl00_ctl00" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socket_members.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl85_ctl00_contenthere|ctl00_MTCS_main_ctl85_ctl00_ctl00',this);">Socket Members</a></div><div class="seeAlsoStyle"><a id="ctl00_MTCS_main_ctl85_ctl00_ctl01" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl85_ctl00_contenthere|ctl00_MTCS_main_ctl85_ctl00_ctl01',this);">System.Net.Sockets Namespace</a></div><div class="seeAlsoStyle"><span><span class="nolink">Net</span></span></div><div class="seeAlsoStyle"><span><a id="ctl00_MTCS_main_ctl85_ctl00_ctl02" href="http://msdn.microsoft.com/en-us/library/system.net.cache.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl85_ctl00_contenthere|ctl00_MTCS_main_ctl85_ctl00_ctl02',this);">System.Net.Cache</a></span></div><div class="seeAlsoStyle"><span><a id="ctl00_MTCS_main_ctl85_ctl00_ctl03" href="http://msdn.microsoft.com/en-us/library/system.net.security.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl85_ctl00_contenthere|ctl00_MTCS_main_ctl85_ctl00_ctl03',this);">System.Net.Security</a></span></div><div class="seeAlsoStyle"><span><a id="ctl00_MTCS_main_ctl85_ctl00_ctl04" href="http://msdn.microsoft.com/en-us/library/system.net.sockets.socketasynceventargs.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl85_ctl00_contenthere|ctl00_MTCS_main_ctl85_ctl00_ctl04',this);">System.Net.Sockets<span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span>SocketAsyncEventArgs</a></span></div><h4 class="subHeading">Other Resources</h4><div class="seeAlsoStyle"><span><a id="ctl00_MTCS_main_ctl85_ctl00_ctl05" href="http://msdn.microsoft.com/en-us/library/4as0wz7t.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl85_ctl00_contenthere|ctl00_MTCS_main_ctl85_ctl00_ctl05',this);">Network Programming</a></span></div><div class="seeAlsoStyle"><span><a id="ctl00_MTCS_main_ctl85_ctl00_ctl06" href="http://msdn.microsoft.com/en-us/library/zhzezf6d.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl85_ctl00_contenthere|ctl00_MTCS_main_ctl85_ctl00_ctl06',this);">Best Practices for System.Net Classes</a></span></div><div class="seeAlsoStyle"><span><a id="ctl00_MTCS_main_ctl85_ctl00_ctl07" href="http://msdn.microsoft.com/en-us/library/6szcd7yh.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl85_ctl00_contenthere|ctl00_MTCS_main_ctl85_ctl00_ctl07',this);">Cache Management for Network Applications</a></span></div><div class="seeAlsoStyle"><span><a id="ctl00_MTCS_main_ctl85_ctl00_ctl08" href="http://msdn.microsoft.com/en-us/library/3x7ak53z.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl85_ctl00_contenthere|ctl00_MTCS_main_ctl85_ctl00_ctl08',this);">Internet Protocol Version 6</a></span></div><div class="seeAlsoStyle"><span><a id="ctl00_MTCS_main_ctl85_ctl00_ctl09" href="http://msdn.microsoft.com/en-us/library/hyb3xww8.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl85_ctl00_contenthere|ctl00_MTCS_main_ctl85_ctl00_ctl09',this);">Network Tracing</a></span></div><div class="seeAlsoStyle"><span><a id="ctl00_MTCS_main_ctl85_ctl00_ctl10" href="http://msdn.microsoft.com/en-us/library/5e0zwwk6.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl85_ctl00_contenthere|ctl00_MTCS_main_ctl85_ctl00_ctl10',this);">Security in Network Programming</a></span></div><div class="seeAlsoStyle"><span><a id="ctl00_MTCS_main_ctl85_ctl00_ctl11" href="http://msdn.microsoft.com/en-us/library/bb968780.aspx" onclick="javascript:Track('ctl00_MTCS_main_ctl85_ctl00_contenthere|ctl00_MTCS_main_ctl85_ctl00_ctl11',this);">Socket Performance Enhancements in Version 3.5</a></span></div>
</div>
</div>
</span></div>
      
    </div></div>
        
          
        </div>
      </div>

      

<span id="CommunityContent"></span>
<div id="ctl00_WikiContent_cc" class="CCS_Container">
			

  <div class="CCS_TopicTagEditor">
	  <div id="ctl00_WikiContent_TopicTagEditor_panel" class="CCT_Panel">
  <div id="tagsPanel" class="CCT_TagsPanel">
    <span id="ctl00_WikiContent_TopicTagEditor_title" class="CCT_Title">Tags</span>
    <a href="/platform/Controls/CCTagEditor/resources/taghelp.htm" id="ctl00_WikiContent_TopicTagEditor_helpLink" class="CCT_HelpLink" onclick="CCS_ShowHelp(&quot;/platform/Controls/CCTagEditor/resources/taghelp.htm&quot;,800,600);return false;">
      <img src="http://i.msdn.microsoft.com/Global/Images/clear.gif" id="ctl00_WikiContent_TopicTagEditor_helpImage" class="CCT_HelpImage LibC_help" alt="What's this?" title="What's this?" /></a>:
    <span id="ctl00_WikiContent_TopicTagEditor_tags" class="CCT_Text"></span>
    <span id="ctl00_WikiContent_TopicTagEditor_view" class="CCT_View">
      <a href="../../Platform/Controls/CCTagEditor/#" id="ctl00_WikiContent_TopicTagEditor_addTagLink" class="CCT_LinkButton" onclick="return CCT_AddATag(&quot;http://msdn.microsoft.com/en-us/library/Community-Signup.aspx?ru=http%3a%2f%2fmsdn.microsoft.com%2fen-us%2flibrary%2fsystem.net.sockets.socket(VS.90).aspx&quot;,-1);" title="Add a tag to this topic">Add a tag</a>
    </span>

    <span id="ctl00_WikiContent_TopicTagEditor_editPanel" style="display:none" class="CCT_Edit">
      <input name="ctl00$WikiContent$TopicTagEditor$textbox" type="text" id="ctl00_WikiContent_TopicTagEditor_textbox" class="CCT_TextBox" autocomplete="off" />
      <a href="../../Platform/Controls/CCTagEditor/#" id="ctl00_WikiContent_TopicTagEditor_addLink" class="CCT_LinkButton" onclick="return CCT_AddTags(-1);" title="Submit the tags for this topic">Add</a>

      &nbsp;
      <a href="../../Platform/Controls/CCTagEditor/#" id="ctl00_WikiContent_TopicTagEditor_cancelLink" class="CCT_LinkButton" onclick="return CCT_CancelAddTag(-1);" title="Cancel this operation">Cancel</a>
    </span>
    <span id="ctl00_WikiContent_TopicTagEditor_messagePanel" class="CCT_Message"></span>
  </div>
  <div id="ctl00_WikiContent_TopicTagEditor_flagAsPanel" class="CCT_FlagAsPanel" style="display:none">
    <span id="ctl00_WikiContent_TopicTagEditor_flagAsLabel">Flag as </span>
    <a href="../../Platform/Controls/CCTagEditor/#" id="ctl00_WikiContent_TopicTagEditor_contentBugLink" class="CCT_LinkButton" onclick="return CCT_FlagContentBug(&quot;http://msdn.microsoft.com/en-us/library/Community-Signup.aspx?ru=http%3a%2f%2fmsdn.microsoft.com%2fen-us%2flibrary%2fsystem.net.sockets.socket(VS.90).aspx&quot;,-1);" title="Flagging this annotation as a 'ContentBug' will let the author know that this topic needs to be reviewed">ContentBug</a>
  </div>
  <div style="clear:both"></div>
</div>

  </div>

  <div class="CCS_WikiLogo">
	  <img id="ctl00_WikiContent_wikiLogo" class="LibC_wiki" src="http://i.msdn.microsoft.com/Global/Images/clear.gif" border="0" />
  </div>

  <div id="ctl00_WikiContent_contentContainer" class="CCS_ContentContainer">
				
    <div id="ctl00_WikiContent_headerContainer" class="CCS_HeaderContainer">
					
			<table cellpadding="0" cellspacing="0" border="0" width="100%" class="CCS_Header">
				<tr>
					<td>
  					<div class="CCS_HeaderTitle">
  					  <span id="ctl00_WikiContent_headerTitle">Community Content</span>&nbsp;&nbsp;
              <a href="/platform/Controls/CCSection/resources/cchelp.htm" id="ctl00_WikiContent_helpLink" class="CCS_HelpLink" onclick="CCS_ShowHelp(&quot;/platform/Controls/CCSection/resources/cchelp.htm&quot;,400,400);return false;"><img src="http://i.msdn.microsoft.com/Global/Images/clear.gif" id="ctl00_WikiContent_helpImage" class="CCS_HelpImage  LibC_help" alt="What is Community Content?" title="What is Community Content?" /></a>
  					</div>
					</td>
				</tr>
			</table>
			<table cellpadding="0" cellspacing="0" border="0" width="100%" class="CCS_Toolbar">
				<tr>
					<td class="CCS_Add">
					  <a id="ctl00_WikiContent_Add" class="CCS_Link" href="javascript:WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions(&quot;ctl00$WikiContent$Add&quot;, &quot;&quot;, false, &quot;&quot;, &quot;http://msdn.microsoft.com/en-us/library/Community-Signup.aspx?ru=http%3a%2f%2fmsdn.microsoft.com%2fen-us%2flibrary%2fsystem.net.sockets.socket(VS.90).aspx%3fwbi%3dnew&quot;, false, true))">Add new content</a>
					</td>
					<td class="CCS_RecentChanges">
					  <a href="http://msdn.microsoft.com/en-us/library/community-edits.rss?topic=attbb8f5|en-us|90" id="ctl00_WikiContent_recentPageLink"><img id="ctl00_WikiContent_imageRSS" class="CCS_RSSImage LibC_rss_button" src="http://i.msdn.microsoft.com/Global/Images/clear.gif" alt="RSS" align="middle" border="0" /></a>&nbsp;
					  <span id="ctl00_WikiContent_recentChangesTitle" class="CCS_RecentChangesText">Annotations</span>
					</td>
					<td align="right" class="CCS_Profile">
						
					</td>
				</tr>
			</table>
    
				</div>

    <div id="ctl00_WikiContent_wikiItems" class="CCS_ItemsContainer">
					<div id="ctl00_WikiContent_ctl00_ItemUpdatePanel">
						
    <div id="ctl00_WikiContent_ctl00_Container" class="CCI_Container" onMouseOver="CCI_Highlight(true,&quot;ctl00_WikiContent_ctl00_Container&quot;);" onMouseOut="CCI_Highlight(false,&quot;ctl00_WikiContent_ctl00_Container&quot;);">
							
      <div id="ctl00_WikiContent_ctl00_Header" class="CCI_Header">
								
        <table width="100%" cellpadding="0" cellspacing="0">
            <tr>
                <td align="left">
                    <span id="ctl00_WikiContent_ctl00_HeaderTitle" class="CCI_Header_Title">Using the Socket class to request the NetBios name of a device over UDP</span>
                </td>
                <td>
                    <span id="ctl00_WikiContent_ctl00_Label2" class="CCI_Header_Spacer">&nbsp;&nbsp;&nbsp;&nbsp;</span>
                </td>

                
                  <td align="right" class="CCI_Header_Actions">
                      <span id="ctl00_WikiContent_ctl00_EditInfo"><a id="ctl00_WikiContent_ctl00_ctl02" title="Last Edited by Joel Ivory Johnson at 8/18/2008 1:08 PM" class="CCI_Header_Link" href="user-49177.aspx" onclick="javascript:Track('ctl00_WikiContent_ctl00_EditInfo|ctl00_WikiContent_ctl00_ctl02',this);">Joel Ivory Johnson</a></span><span id="ctl00_WikiContent_ctl00_Separator">
                        &nbsp;&nbsp;|&nbsp;&nbsp;
                      </span><span id="ctl00_WikiContent_ctl00_EditLabel"><a id="ctl00_WikiContent_ctl00_Edit" title="Edit this version" class="CCI_Header_Link" href="javascript:WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions(&quot;ctl00$WikiContent$ctl00$Edit&quot;, &quot;&quot;, false, &quot;&quot;, &quot;http://msdn.microsoft.com/en-us/library/Community-Signup.aspx?ru=http%3a%2f%2fmsdn.microsoft.com%2fen-us%2flibrary%2fsystem.net.sockets.socket(VS.90).aspx%3fwbi%3d1&quot;, false, true))">Edit</a></span><input name="ctl00$WikiContent$ctl00$showhistoryFlag" type="text" id="ctl00_WikiContent_ctl00_showhistoryFlag" style="display: none" value="false" /><span id="ctl00_WikiContent_ctl00_HistoryLabel">
                        &nbsp;&nbsp;|&nbsp;&nbsp;
                        <a id="ctl00_WikiContent_ctl00_History" title="Show/Hide History" class="CCI_Header_Link" href="javascript:__doPostBack('ctl00$WikiContent$ctl00$History','')">Show History</a></span>
                  </td>
                
                
            </tr>
        </table>
      
							</div>

      <div id="ctl00_WikiContent_ctl00_HistoryContent" height="0px" style="overflow:hidden">
								
          <div id="ctl00_WikiContent_ctl00_HistoryUpdatePanel">
									

              <a id="ctl00_WikiContent_ctl00_ibLoad" href="javascript:__doPostBack('ctl00$WikiContent$ctl00$ibLoad','')" style="display:inline-block;position:absolute;display:none;"></a>
            
              <div id="ctl00_WikiContent_ctl00_HistoryUpdateProgress" style="display:none;">
										
                <div style="text-align:center;font-size:9pt">
											Please Wait&nbsp;&nbsp;<img class="LibC_spinner" src="http://i.msdn.microsoft.com/Global/Images/clear.gif" alt="Please Wait" border="0" style="vertical-align:middle" />
										</div>
									</div>
            
              <div id="ctl00_WikiContent_ctl00_HistoryContainer" class="CCI_HistoryContent" style="">
										
              
									</div>
              
            
								</div>
      
							</div>

      <div id="ctl00_WikiContent_ctl00_EditorPanel" class="CCI_Text" ondblclick="document.location.href=&quot;http://msdn.microsoft.com/en-us/library/Community-Signup.aspx?ru=http%3a%2f%2fmsdn.microsoft.com%2fen-us%2flibrary%2fsystem.net.sockets.socket(VS.90).aspx%3fwbi%3d1&quot;;" style="cursor:default;">
								
        <div id="ctl00_WikiContent_ctl00_Editor_Container">
									
	  
    <div id="ctl00_WikiContent_ctl00_Editor_RadEditor" title="Double-click to edit this block" class=" CCE_Editor_Disabled" style="height:auto;width:auto;">
										<!-- 2008.2.723.35 --><p>Many Windows and non-Windows based network devices will respond with their name to a NetBios name request sent on UDP port 137. The following code demonstrates the use of the Socket class to send such a request. The program takes as it's only command line argument the IP address of a target machine. The use of the ReceiveTimeOut socket option is needed to prevent the program from waiting indefinitly should the specified IP address not belong to a machine or should that machine not respond with it's NetBios name. <br /><br /></p>
<pre>using System;<br />using System.Text;<br />using System.Net;<br />using System.Net.Sockets;<br /><br />namespace UDPSocketExample<br />{<br />    class Program<br />    {<br />        // The following byte stream contains the necessary message<br />        // to request a NetBios name from a machine<br />        static byte[] NameRequest = new byte[]{ <br />            0x80, 0x94, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, <br />            0x00, 0x00, 0x00, 0x00, 0x20, 0x43, 0x4b, 0x41, <br />            0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, <br />            0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, <br />            0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, <br />            0x41, 0x41, 0x41, 0x41, 0x41, 0x00, 0x00, 0x21, <br />            0x00, 0x01 };<br /><br /><br />         static void Main(string[] args)<br />         {<br />             if (args.Length &lt; 1)<br />             {<br />                 Console.Out.WriteLine("Usage: xxx.exe [IP Address]");<br />                 return ;<br />             }<br />             byte[] receiveBuffer = new byte[1024];<br />             Socket requestSocket = new Socket(AddressFamily.InterNetwork, SocketType.Dgram, ProtocolType.Udp);<br />             requestSocket.SetSocketOption(SocketOptionLevel.Socket, SocketOptionName.ReceiveTimeout, 1000);<br />             IPAddress[] addressList = Dns.GetHostAddresses(args[0]);<br />             if (addressList.Length == 0)<br />             {<br />                 Console.Out.WriteLine("The requested host could not be found ({0})", args[0]);<br />                 return;<br />             }<br /><br />             EndPoint remoteEndpoint = new IPEndPoint(addressList[0],137);<br />             IPEndPoint originEndpoint = new IPEndPoint(IPAddress.Any, 0);<br />             requestSocket.Bind(originEndpoint);<br />             requestSocket.SendTo(NameRequest, remoteEndpoint);<br />             try<br />             {<br /><br />                 int receivedByteCount = requestSocket.ReceiveFrom(receiveBuffer, ref remoteEndpoint);<br />                 if (receivedByteCount &gt;= 90)<br />                 {<br />                     Encoding enc = new ASCIIEncoding();<br />                     string dnsEntryName = Dns.GetHostByAddress(addressList[0]).HostName;<br />                     string deviceName = enc.GetString(receiveBuffer, 57, 16).Trim();<br />                     string networkName = enc.GetString(receiveBuffer, 75, 16).Trim();<br />                     Console.Out.WriteLine(String.Format( "Request Sent to :{0}\n\r"+<br />                             "NetBios Query Result:{1}\r\n"+<br />                             "Reverse DNS Lookup :{2}\r\n", args[0],deviceName,dnsEntryName));<br />                 }<br />             }<br />             catch (SocketException )<br />             {<br />                 Console.Out.WriteLine(String.Format("The device identified by {0} could not be identified by a NetBios name",args[0]));<br />             }<br />         } <br />     }<br />}<br /></pre>
<p>
  <br />
</p>
									</div>
    <input type="hidden" name="ctl00$WikiContent$ctl00$Editor$editorData" id="ctl00_WikiContent_ctl00_Editor_editorData" value="&lt;p>Many Windows and non-Windows based network devices will respond with their name to a NetBios name request sent on UDP port 137. The following code demonstrates the use of the Socket class to send such a request. The program takes as it's only command line argument the IP address of a target machine. The use of the ReceiveTimeOut socket option is needed to prevent the program from waiting indefinitly should the specified IP address not belong to a machine or should that machine not respond with it's NetBios name. &lt;br />&lt;br />&lt;/p>
&lt;pre>using System;&lt;br />using System.Text;&lt;br />using System.Net;&lt;br />using System.Net.Sockets;&lt;br />&lt;br />namespace UDPSocketExample&lt;br />{&lt;br />    class Program&lt;br />    {&lt;br />        // The following byte stream contains the necessary message&lt;br />        // to request a NetBios name from a machine&lt;br />        static byte[] NameRequest = new byte[]{ &lt;br />            0x80, 0x94, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, &lt;br />            0x00, 0x00, 0x00, 0x00, 0x20, 0x43, 0x4b, 0x41, &lt;br />            0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, &lt;br />            0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, &lt;br />            0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, &lt;br />            0x41, 0x41, 0x41, 0x41, 0x41, 0x00, 0x00, 0x21, &lt;br />            0x00, 0x01 };&lt;br />&lt;br />&lt;br />         static void Main(string[] args)&lt;br />         {&lt;br />             if (args.Length &amp;lt; 1)&lt;br />             {&lt;br />                 Console.Out.WriteLine(&quot;Usage: xxx.exe [IP Address]&quot;);&lt;br />                 return ;&lt;br />             }&lt;br />             byte[] receiveBuffer = new byte[1024];&lt;br />             Socket requestSocket = new Socket(AddressFamily.InterNetwork, SocketType.Dgram, ProtocolType.Udp);&lt;br />             requestSocket.SetSocketOption(SocketOptionLevel.Socket, SocketOptionName.ReceiveTimeout, 1000);&lt;br />             IPAddress[] addressList = Dns.GetHostAddresses(args[0]);&lt;br />             if (addressList.Length == 0)&lt;br />             {&lt;br />                 Console.Out.WriteLine(&quot;The requested host could not be found ({0})&quot;, args[0]);&lt;br />                 return;&lt;br />             }&lt;br />&lt;br />             EndPoint remoteEndpoint = new IPEndPoint(addressList[0],137);&lt;br />             IPEndPoint originEndpoint = new IPEndPoint(IPAddress.Any, 0);&lt;br />             requestSocket.Bind(originEndpoint);&lt;br />             requestSocket.SendTo(NameRequest, remoteEndpoint);&lt;br />             try&lt;br />             {&lt;br />&lt;br />                 int receivedByteCount = requestSocket.ReceiveFrom(receiveBuffer, ref remoteEndpoint);&lt;br />                 if (receivedByteCount &amp;gt;= 90)&lt;br />                 {&lt;br />                     Encoding enc = new ASCIIEncoding();&lt;br />                     string dnsEntryName = Dns.GetHostByAddress(addressList[0]).HostName;&lt;br />                     string deviceName = enc.GetString(receiveBuffer, 57, 16).Trim();&lt;br />                     string networkName = enc.GetString(receiveBuffer, 75, 16).Trim();&lt;br />                     Console.Out.WriteLine(String.Format( &quot;Request Sent to :{0}\n\r&quot;+&lt;br />                             &quot;NetBios Query Result:{1}\r\n&quot;+&lt;br />                             &quot;Reverse DNS Lookup :{2}\r\n&quot;, args[0],deviceName,dnsEntryName));&lt;br />                 }&lt;br />             }&lt;br />             catch (SocketException )&lt;br />             {&lt;br />                 Console.Out.WriteLine(String.Format(&quot;The device identified by {0} could not be identified by a NetBios name&quot;,args[0]));&lt;br />             }&lt;br />         } &lt;br />     }&lt;br />}&lt;br />&lt;/pre>
&lt;p>
  &lt;br />
&lt;/p>" />
    <input type="hidden" name="ctl00$WikiContent$ctl00$Editor$tagEditorData" id="ctl00_WikiContent_ctl00_Editor_tagEditorData" value="socket udp " />
    
    
  
								</div>

      
							</div>

      <div id="ctl00_WikiContent_ctl00_TagEditor_panel" class="CCT_Panel_Block">
  <div id="tagsPanel" class="CCT_TagsPanel">
    <span id="ctl00_WikiContent_ctl00_TagEditor_title" class="CCT_Title">Tags</span>
    <a href="/platform/Controls/CCTagEditor/resources/taghelp.htm" id="ctl00_WikiContent_ctl00_TagEditor_helpLink" class="CCT_HelpLink" onclick="CCS_ShowHelp(&quot;/platform/Controls/CCTagEditor/resources/taghelp.htm&quot;,800,600);return false;">
      <img src="http://i.msdn.microsoft.com/Global/Images/clear.gif" id="ctl00_WikiContent_ctl00_TagEditor_helpImage" class="CCT_HelpImage LibC_help" alt="What's this?" title="What's this?" /></a>:
    <span id="ctl00_WikiContent_ctl00_TagEditor_tags" class="CCT_Text"><span class="CCT_TagPair"><a id="tagLink_0_1" href="#" onclick="return CCT_BrowseTag(&quot;http://msdn.microsoft.com/en-us/library/Tags-Cloud.aspx?tag=socket&quot;,1);" title="Browse other topics containing this tag" class="CCT_Link">socket</a> (<a id="removeTagLink_0_1" href="#" onclick="return CCT_RemoveTag(&quot;socket&quot;,&quot;http://msdn.microsoft.com/en-us/library/Community-Signup.aspx?ru=http%3a%2f%2fmsdn.microsoft.com%2fen-us%2flibrary%2fsystem.net.sockets.socket(VS.90).aspx&quot;,1);" title="Remove the tag from this topic" class="CCT_Link">x</a>) </span><span class="CCT_TagPair"><a id="tagLink_1_1" href="#" onclick="return CCT_BrowseTag(&quot;http://msdn.microsoft.com/en-us/library/Tags-Cloud.aspx?tag=udp&quot;,1);" title="Browse other topics containing this tag" class="CCT_Link">udp</a> (<a id="removeTagLink_1_1" href="#" onclick="return CCT_RemoveTag(&quot;udp&quot;,&quot;http://msdn.microsoft.com/en-us/library/Community-Signup.aspx?ru=http%3a%2f%2fmsdn.microsoft.com%2fen-us%2flibrary%2fsystem.net.sockets.socket(VS.90).aspx&quot;,1);" title="Remove the tag from this topic" class="CCT_Link">x</a>) </span></span>
    <span id="ctl00_WikiContent_ctl00_TagEditor_view" class="CCT_View">
      <a href="../../Platform/Controls/CCTagEditor/#" id="ctl00_WikiContent_ctl00_TagEditor_addTagLink" class="CCT_LinkButton" onclick="return CCT_AddATag(&quot;http://msdn.microsoft.com/en-us/library/Community-Signup.aspx?ru=http%3a%2f%2fmsdn.microsoft.com%2fen-us%2flibrary%2fsystem.net.sockets.socket(VS.90).aspx&quot;,1);" title="Add a tag to this topic">Add a tag</a>
    </span>

    <span id="ctl00_WikiContent_ctl00_TagEditor_editPanel" style="display:none" class="CCT_Edit">
      <input name="ctl00$WikiContent$ctl00$TagEditor$textbox" type="text" id="ctl00_WikiContent_ctl00_TagEditor_textbox" class="CCT_TextBox" autocomplete="off" />
      <a href="../../Platform/Controls/CCTagEditor/#" id="ctl00_WikiContent_ctl00_TagEditor_addLink" class="CCT_LinkButton" onclick="return CCT_AddTags(1);" title="Submit the tags for this topic">Add</a>

      &nbsp;
      <a href="../../Platform/Controls/CCTagEditor/#" id="ctl00_WikiContent_ctl00_TagEditor_cancelLink" class="CCT_LinkButton" onclick="return CCT_CancelAddTag(1);" title="Cancel this operation">Cancel</a>
    </span>
    <span id="ctl00_WikiContent_ctl00_TagEditor_messagePanel" class="CCT_Message"></span>
  </div>
  <div id="ctl00_WikiContent_ctl00_TagEditor_flagAsPanel" class="CCT_FlagAsPanel" style="display:;">
    <span id="ctl00_WikiContent_ctl00_TagEditor_flagAsLabel">Flag as </span>
    <a href="../../Platform/Controls/CCTagEditor/#" id="ctl00_WikiContent_ctl00_TagEditor_contentBugLink" class="CCT_LinkButton" onclick="return CCT_FlagContentBug(&quot;http://msdn.microsoft.com/en-us/library/Community-Signup.aspx?ru=http%3a%2f%2fmsdn.microsoft.com%2fen-us%2flibrary%2fsystem.net.sockets.socket(VS.90).aspx&quot;,1);" title="Flagging this annotation as a 'ContentBug' will let the author know that this topic needs to be reviewed">ContentBug</a>
  </div>
  <div style="clear:both"></div>
</div>


    
						</div>
  
					</div>
<div id="ctl00_WikiContent_ctl01_ItemUpdatePanel">
						
    <div id="ctl00_WikiContent_ctl01_Container" class="CCI_Container" style="display:none;">
							
      <div id="ctl00_WikiContent_ctl01_Header" class="CCI_Header">
								
        <table width="100%" cellpadding="0" cellspacing="0">
            <tr>
                <td align="left">
                    <span id="ctl00_WikiContent_ctl01_HeaderTitle" class="CCI_Header_Title"></span>
                </td>
                <td>
                    <span id="ctl00_WikiContent_ctl01_Label2" class="CCI_Header_Spacer">&nbsp;&nbsp;&nbsp;&nbsp;</span>
                </td>

                
                  <td align="right" class="CCI_Header_Actions">
                      <span id="ctl00_WikiContent_ctl01_EditInfo"></span><span id="ctl00_WikiContent_ctl01_Separator">
                        &nbsp;&nbsp;|&nbsp;&nbsp;
                      </span><span id="ctl00_WikiContent_ctl01_EditLabel"><a id="ctl00_WikiContent_ctl01_Edit" title="Edit this version" class="CCI_Header_Link" href="javascript:__doPostBack('ctl00$WikiContent$ctl01$Edit','')">Edit</a></span><input name="ctl00$WikiContent$ctl01$showhistoryFlag" type="text" id="ctl00_WikiContent_ctl01_showhistoryFlag" style="display: none" value="false" />
                  </td>
                
                
            </tr>
        </table>
      
							</div>

      

      <div id="ctl00_WikiContent_ctl01_EditorPanel" class="CCI_Text" style="cursor:default;">
								
        <div id="ctl00_WikiContent_ctl01_Editor_Container">
									
	  
    <div id="ctl00_WikiContent_ctl01_Editor_RadEditor" title="Double-click to edit this block" class=" CCE_Editor_Disabled" style="height:auto;width:auto;">
										
									</div>
    <input type="hidden" name="ctl00$WikiContent$ctl01$Editor$editorData" id="ctl00_WikiContent_ctl01_Editor_editorData" />
    <input type="hidden" name="ctl00$WikiContent$ctl01$Editor$tagEditorData" id="ctl00_WikiContent_ctl01_Editor_tagEditorData" />
    
    
  
								</div>

      
							</div>

      <div id="ctl00_WikiContent_ctl01_TagEditor_panel" class="CCT_Panel">
  <div id="tagsPanel" class="CCT_TagsPanel">
    <span id="ctl00_WikiContent_ctl01_TagEditor_title" class="CCT_Title">Tags</span>
    <a href="/platform/Controls/CCTagEditor/resources/taghelp.htm" id="ctl00_WikiContent_ctl01_TagEditor_helpLink" class="CCT_HelpLink" onclick="CCS_ShowHelp(&quot;/platform/Controls/CCTagEditor/resources/taghelp.htm&quot;,800,600);return false;">
      <img src="http://i.msdn.microsoft.com/Global/Images/clear.gif" id="ctl00_WikiContent_ctl01_TagEditor_helpImage" class="CCT_HelpImage LibC_help" alt="What's this?" title="What's this?" /></a>:
    <span id="ctl00_WikiContent_ctl01_TagEditor_tags" class="CCT_Text"></span>
    <span id="ctl00_WikiContent_ctl01_TagEditor_view" class="CCT_View">
      <a href="../../Platform/Controls/CCTagEditor/#" id="ctl00_WikiContent_ctl01_TagEditor_addTagLink" class="CCT_LinkButton" title="Add a tag to this topic">Add a tag</a>
    </span>

    <span id="ctl00_WikiContent_ctl01_TagEditor_editPanel" style="display:none" class="CCT_Edit">
      <input name="ctl00$WikiContent$ctl01$TagEditor$textbox" type="text" id="ctl00_WikiContent_ctl01_TagEditor_textbox" class="CCT_TextBox" autocomplete="off" />
      <a href="../../Platform/Controls/CCTagEditor/#" id="ctl00_WikiContent_ctl01_TagEditor_addLink" class="CCT_LinkButton" title="Submit the tags for this topic">Add</a>

      &nbsp;
      <a href="../../Platform/Controls/CCTagEditor/#" id="ctl00_WikiContent_ctl01_TagEditor_cancelLink" class="CCT_LinkButton" title="Cancel this operation">Cancel</a>
    </span>
    <span id="ctl00_WikiContent_ctl01_TagEditor_messagePanel" class="CCT_Message"></span>
  </div>
  <div id="ctl00_WikiContent_ctl01_TagEditor_flagAsPanel" class="CCT_FlagAsPanel" style="display:none">
    <span id="ctl00_WikiContent_ctl01_TagEditor_flagAsLabel">Flag as </span>
    <a href="../../Platform/Controls/CCTagEditor/#" id="ctl00_WikiContent_ctl01_TagEditor_contentBugLink" class="CCT_LinkButton" onclick="return CCT_FlagContentBug(&quot;http://msdn.microsoft.com/en-us/library/Community-Signup.aspx?ru=http%3a%2f%2fmsdn.microsoft.com%2fen-us%2flibrary%2fsystem.net.sockets.socket(VS.90).aspx&quot;,-1);" title="Flagging this annotation as a 'ContentBug' will let the author know that this topic needs to be reviewed">ContentBug</a>
  </div>
  <div style="clear:both"></div>
</div>


    
						</div>
  
					</div>

				</div>

    <div id="ctl00_WikiContent_EditorPanel" class="CCI_Container_Edit" style="display:none">
					
      <div id="ctl00_WikiContent_Editor_Container">
						
	  
    <div id="ctl00_WikiContent_Editor_RadEditor" title="Double-click to edit this block" class=" CCE_Editor_Disabled" style="height:auto;width:auto;">
							
						</div>
    <input type="hidden" name="ctl00$WikiContent$Editor$editorData" id="ctl00_WikiContent_Editor_editorData" />
    <input type="hidden" name="ctl00$WikiContent$Editor$tagEditorData" id="ctl00_WikiContent_Editor_tagEditorData" />
    
    
  
					</div>

    
				</div>
    

    <div id="ProgressIndicator" class="CCS_Progress">
      <img src="http://i.msdn.microsoft.com/Global/Images/clear.gif" id="ctl00_WikiContent_progressImage" class="LibC_spinner" alt="Processing" />
    </div>

    <div class="CCS_Footer"></div>
   
			</div>

		</div>
      

<div style="overflow:hidden;display:block;position:relative;">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
  <tr>
    <td id="ctl00_mtpsFooter_FooterFadeCell" class="MTPS_FooterFade">
      <div id="ctl00_mtpsFooter_SiteLinks" class="MTPS_FooterLinks">

		</div>
      <span id="ctl00_mtpsFooter_MSFT_copyright" title="© 2010  Microsoft Corporation. All rights reserved." class="MTPS_FooterCopyright">&copy; 2010  Microsoft Corporation. All rights reserved.</span>
      <a id="ctl00_mtpsFooter_MSFT_Terms" title="Terms of Use" class="MTPS_FooterLinks" href="/cc300389.aspx">Terms of Use</a>
      <span id="ctl00_mtpsFooter_PipeSpan1">|</span>
      <a id="ctl00_mtpsFooter_MSFT_Trademarks" title="Trademarks" class="MTPS_FooterLinks" href="http://www.microsoft.com/library/toolbar/3.0/trademarks/en-us.mspx">Trademarks</a>
      <span id="ctl00_mtpsFooter_PipeSpan2">|</span>
      <a id="ctl00_mtpsFooter_MSFT_PrivacyStatement" title="Privacy Statement" class="MTPS_FooterLinks" href="http://www.microsoft.com/info/privacy.mspx">Privacy Statement</a>
      
      <a id="ctl00_mtpsFooter_MSFT_Feedback" class="MTPS_FooterLinks" rel="sitefeedback" target="_blank"></a>
    </td>
		
    <td id="ctl00_mtpsFooter_FooterLogoCell">
      <a id="ctl00_mtpsFooter_MSFT_LOGO" title="Microsoft Corporation" href="http://www.microsoft.com/en/us/default.aspx"><img id="ctl00_mtpsFooter_MSFT_imgLogo" class="msdn_TabC_mslogo" src="http://i.msdn.microsoft.com/Global/Images/clear.gif" border="0" /></a>
    </td>
		
  </tr>
</table>

</div>
 
      
	</div>
</div>
  </div>
  <div style="display:none"><img src="http://c.microsoft.com/trans_pixel.asp?source=msdn&amp;TYPE=PV&amp;uri=%2fen-us%2flibrary(d%3ddefault)%2fattbb8f5(l%3den-us%2cv%3dVS.90).aspx&amp;p=_en-us_library(d=default)_attbb8f5(l=en-us,v=VS.90).aspx" width="0" height="0" hspace="0" vspace="0" border="0" alt="Page view tracker" /></div>
  
<script src="http://i2.msdn.microsoft.com/platform/Controls/WebTrends/resources/webtrendsscript-bn20100217.js" type="text/javascript"></script>
<noscript>
<div><img alt="DCSIMG" id="Img1" width="1" height="1" src="http://m.webtrends.com/dcsmgru7m99k7mqmgrhudo0k8_8c6m/njs.gif?dcsuri=/nojavascript&amp;WT.js=No" /></div>
</noscript>
  <script type="text/javascript" src="http://i2.msdn.microsoft.com/en-us/library/mtps-bn20100217.js?l=en-us&amp;i=library&amp;ct=AlternateSelector;CCEditor;CCItem;CCSection;CCTagEditor;CodeSnippet;CollapsibleArea;ContentFallback;DropDownFilter;ExpandCollapseAll;Eyebrow;Footer;InstrumentedLink;InteractiveToolbar;iRootBrand;KTableControl;LanguageSpecificText;LocaleManagementFlyout;lwViewSwitcher;MastheadLibrary;MemberlistFrameworksFilter;MemberlistMembersFilter;MtpsLoginStatus;MtpsRating;MtViewDropDown;Omniture;RedVelvetCodeSnippet;RedVelvetCollapsibleArea;RedVelvetInstrumentedLink;RelatedPages;ResizeableAreaD10;StoSearch;StoTabStripLibrary;SurveyLauncher;TagCloud;TemplatedFlyout;Tickler;Toc;UserRecognition;WebMetrix;WebTrends"></script>
    <script type="text/javascript">
        //<![CDATA[
        setTimeout(function() {
            var hashElementId = document.location.hash.substr(1);
            var hashElement = document.getElementById(hashElementId);
            if (hashElement != null) {
                hashElement.scrollIntoView(true);
            }
        }, 1);
        //]]>
    </script>
  

<script type="text/javascript">
//<![CDATA[
Sys.WebForms.PageRequestManager.getInstance().add_beginRequest(CCS_BeginRequestHandler);Sys.WebForms.PageRequestManager.getInstance().add_endRequest(CCS_EndRequestHandler); RegisterAutoSubmit('ctl00_ib1_Flyout_Rating1','ctl00_ib1_Flyout_btnSend','contentRatingattbb8f5VS.90en-us');
//]]>
</script>
<script type="text/javascript" language="javascript">
<!--
 function GetContentWnd(){ return parent; } function OnInitPage(){var oWnd = GetContentWnd();} function OnSave(){ var oWnd = GetContentWnd(); window.external.addFavorite('http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.aspx', oWnd.document.title ); }

-->
</script>
<script type="text/javascript">
//<![CDATA[
document.getElementById('ctl00_ib1_Flyout_rtgContainer').title="Click a star and provide feedback";
CCT_Init("false","http%3a%2f%2fmsdn.microsoft.com%2fen-us%2flibrary%2fsystem.net.sockets.socket.aspx");$addHandler($get("ctl00_WikiContent_TopicTagEditor_editPanel"),"keydown",CCT_KeyDown);$addHandler($get("ctl00_WikiContent_ctl00_TagEditor_editPanel"),"keydown",CCT_KeyDown);Sys.Application.initialize();
TFly_Init('ctl00_ctl10_LocaleManagement_ctl00',0,0,1,0,0,'LocaleManagementFlyoutStaticHover','',0,400,'','','','');
TFly_Init('ctl00_ib1_Flyout',5,2,1,0,0,'','',0,400,'','TFlyPreAnimate','','');
MTPS.Controls.MtpsRating.createMtpsRating('ctl00_ib1_Flyout_Rating1','ratingStar','filledRatingStar','emptyRatingStar','savedRatingStar','5','LeftToRightTopToBottom', false);MTPS.Controls.ResizeableArea = new MTPS.Controls.CreateResizeableArea('ctl00_LibFrame','ctl00_raSplitter','ctl00_raLeft','ctl00_raRight','tocwidth','toccollapsed','173');var tocVectorObject;var hostbase;var closedImg;var openImg;var emptyImg;var loadingImg;var tocVector;var tocIndex = 0;var holder;var tocLoaded = false;var tocCollapsed = 'False';tocVectorObject = {"nodes": [{"id": "ms310241(n)" ,"url": "/ms310241(n)"},{"id": "aa139615(n)" ,"url": "/aa139615(n)"},{"id": "bb400859(n)" ,"url": "/bb400859(n)"},{"id": "bb962012(n)" ,"url": "/bb962012(n)"},{"id": "cc688928(n)" ,"url": "/cc688928(n)"},{"id": "cc688965(n)" ,"url": "/cc688965(n)"}]};hostbase ="http://msdn.microsoft.com/en-us/library";tocVector = eval(tocVectorObject);closedImg = "LibC_c";openImg = "LibC_o";emptyImg = "LibC_e";var tocDir = false;TFly_Init('ctl00_eb1_ctl00',0,-1,-1,0,0,'statHover','',0,0,'EyeBrowMenuBarSetHeight','ExpEye','','');
TFly_Init('ctl00_eb1_ctl01',0,-1,-1,0,0,'statHover','',0,0,'EyeBrowMenuBarSetHeight','ExpEye','','');
TFly_Init('ctl00_eb1_ctl02',0,-1,-1,0,0,'statHover','',0,0,'EyeBrowMenuBarSetHeight','ExpEye','','');
TFly_Init('ctl00_eb1_ctl03',0,-1,-1,0,0,'statHover','',0,0,'EyeBrowMenuBarSetHeight','ExpEye','','');
TFly_Init('ctl00_eb1_ctl04',0,-1,-1,0,0,'statHover','',0,0,'EyeBrowMenuBarSetHeight','ExpEye','','');
TFly_Init('ctl00_eb1_ctl05',0,-1,-1,0,0,'statHover','',0,0,'EyeBrowMenuBarSetHeight','ExpEye','','');
TFly_Init('ctl00_eb1_ctl06',0,-1,-1,0,0,'statHover','',0,0,'EyeBrowMenuBarSetHeight','ExpEye','','');
CheckDropDownClientCookie(true);SetFilterText(true);//]]>
</script>
</form>
</body>

<script language="javascript" type="text/javascript" src="http://js.microsoft.com/library/svy/sto/broker.js"></script>
</html>
