

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head id="ctl00_Head1"><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>
	Connecting and Disconnecting - How to POP3 in C# - developer Fusion - ASP.NET, C# Programming, VB.NET, .NET Framework, Java and Visual Basic Tutorials
</title>
    <meta name="tweetmeme-title" content="Connecting and Disconnecting - How to POP3 in C# - developer Fusion" />
    <meta content="The first method of our Pop3 class is the Connect method. This method takes a server name, username and password parameter to connect to a remote (sometimes local) POP3 server.  public void Connect(string server, string username, string password)  {  string message;  string response;    " name="description" /><meta content="noodp,noydir" name="robots" /><meta content="cpp, email, pop3, sockets, tcp ip" name="keywords" />
    <link href="http://cdn.developerfusion.com/site.compressed.css" media="all" rel="stylesheet" type="text/css" />
    
    <link href="http://cdn.developerfusion.com/websitespark.css" media="all" rel="stylesheet" type="text/css" />
    </head>

<body id="body">
       <div id="takeover_left"><a onclick="javascript: pageTracker._trackPageview ('/outgoing/websitespark-takeoverleft');" href="http://ads2.net-communities.co.uk/openx/www/delivery/ck.php?bannerid=2316" target="_blank"><img src="http://ads2.net-communities.co.uk/openx/www/delivery/avw.php?bannerid=2316&amp;cb=14124124"  width="100%" height="384px" /></a></div>
       <div id="takeover_right"><a onclick="javascript: pageTracker._trackPageview ('/outgoing/websitespark-takeoverright');" href="http://ads2.net-communities.co.uk/openx/www/delivery/ck.php?bannerid=2316" target="_blank"><img src="http://ads2.net-communities.co.uk/openx/www/delivery/avw.php?bannerid=2316&amp;cb=14124124" width="100%" height="384px"  /></a></div>
<div id="wrapper">
<div id="header">
    <div id="logo"><a href="/">Developer Fusion - The global developer community for .NET and Java programmers</a></div>
    <div id="shortcuts">
        <ul id="shortcuts-menu">
            <li><a href="#">Developer Zones</a>
                <ul>
                    <li><a href="/tag/asp.net/">ASP.NET</a></li>
                    <li><a href="/tag/csharp/">C#</a></li>
                    <li><a href="/tag/vb.net/">VB.NET</a></li>
                    <li><a href="/tag/java/">Java</a></li>
                    <li><a href="/tag/cpp/">C++</a></li>
                </ul>
            </li>
        </ul>
    </div>
</div>
<div id="nav">


<ul>
    <li class="library selected"><a href="/library/">Library</a></li>
    <li class="news"><a href="/news/">News</a></li>
    <li class="community"><a href="/community/">Community</a></li>
    <li class="marketplace"><a href="/marketplace/">Marketplace</a></li>
    <li class="websiteSpark"><a href="/websitespark/">Website Spark</a></li>
    <li class="labs"><a href="/tools/">Toolbox</a></li>
    <li class="search">
    <form action="/search/" method="get">
    <fieldset>
    <div class="search-panel">
        <input type="text" class="search-query text_autoclear" name="query" value="Search this site" id="search_query" maxlength="20" />
        <input type="submit" class="search-button" value="  " title="Search" />
    </div>
    </fieldset>
    </form></li>
</ul>

</div>
<div id="content" class="clearfix withleaderboard">
    <div id="main-content" class="clearfix">
        
<div class="detail-page">
    
 <h1 class="intro"><a href="/library/">Library</a>  <span class="tagline"><a href="/library/articles/">tutorials &amp; articles</a></span></h1>
 
    <h1>How to POP3 in C#</h1>
    <div class="article-info clearfix">
        
<ul class="detail-functions">
    <li class="comments"><a href="#comments">Comments (10)</a></li>
    
    <li class="pdf"><a href="/library/pdf/4071/">PDF</a></li>
    
    <li class="other">
        <script type="text/javascript">
            tweetmeme_style = 'compact';
            tweetmeme_source = 'developerfusion';
        </script>
        <script type="text/javascript" src="http://tweetmeme.com/i/scripts/button.js"></script>
    </li>
    <li class="other" id="addthis_widget">
        <a href="http://www.addthis.com/bookmark.php" rel="nofollow"><img src="http://s9.addthis.com/button1-share.gif" width="125" height="16" alt="AddThis" /></a>
    </li>
    
</ul>
        By <a href="/profile/randy/" id="author-name">Randy Charles Morin</a>, published  on 01 Oct 2003
    </div>
    
<ul class="related-tags-panel">
<li><a href="/tag/cpp/">c++</a></li><li><a href="/tag/email/">email</a></li><li><a href="/tag/pop3/">pop3</a></li><li><a href="/tag/sockets/">sockets</a></li><li><a href="/tag/tcp+ip/">tcp ip</a></li>
</ul>

<div id="page-position">
    <a class="page-number" href="javascript:void(0);">Page 3 of 7</a>
    
<ol class="contents-table">

    <li><a href="/article/4071/how-to-pop3-in-c/">Introduction</a>
        </li>

    <li><a href="/article/4071/how-to-pop3-in-c/2/">Getting Started</a>
        </li>

    <li>Connecting and Disconnecting
        </li>

    <li><a href="/article/4071/how-to-pop3-in-c/4/">Retrieving Messages</a>
        </li>

    <li><a href="/article/4071/how-to-pop3-in-c/5/">Removing Messages</a>
        </li>

    <li><a href="/article/4071/how-to-pop3-in-c/6/">Supporting Functions</a>
        </li>

    <li><a href="/article/4071/how-to-pop3-in-c/7/">Using the Class</a>
        </li>

</ol>

</div>

<h2 class="page-title">Connecting and Disconnecting</h2>


<div class="cms-content">
    <p>The first method of our Pop3 class is the Connect method. This
    method takes a server name, username and password parameter to connect to
  a remote (sometimes local) POP3 server.</p>
<p>
  <code class="pre">public void Connect(string server, string username, string
    password) <br />
  { <br />
    string message; <br />
    string response; <br /><br />
    Connect(server, 110); <br />
    response = Response(); <br />
    if (response.Substring(0, 3) != "+OK") <br />
    { <br />
        throw new Pop3Exception(response); <br />
    } <br /><br />
    message = "USER " + username + "\r\n"; <br />
    Write(message); <br />
    response = Response(); <br />
    if (response.Substring(0, 3) != "+OK") <br />
    { <br />
        throw new Pop3Exception(response); <br />
    } <br /><br />
    message = "PASS " + password + "\r\n"; <br />
    Write(message); <br />
    response = Response(); <br />
    if (response.Substring(0, 3) != "+OK") <br />
    { <br />
        throw new Pop3Exception(response); <br />
    } <br />
  }</code>
</p>
<p>We begin by calling the <code>TcpClient.Connect </code>method passing the
  server name and the 110 port. The 110 port number is the well known port number
  for POP3 operations. What that means is that POP3 servers by default should
  listen for connections on port 110. When the POP3 server connects to a client,
  it should immediately respond with the <code>+OK</code> acknowledgement message.
  Next we send two messages, <code>USER</code> and <code>PASS</code>, back to
  the server. The POP3 server should acknowledge a successful login by acknowledging
  both messages. If the POP3 server returns anything but <code>+OK</code>, then
  the message will contain the reason for the failure. In the advent of a failure,
  I attach that failure message to our exception class and throw it back to the
  client. It should be noted that some POP3 servers don't require authentication
  and may reject the calls to <code>USER</code> and <code>PASS</code>. I haven't
  encountered such a POP3 server, but the protocol allows it. In those cases,
  you'll have to slightly modify the class to make things work. </p>
<p>Any use of our Pop3 class should begin with a call to <code>Connect</code> and
  end with a class to <code>Disconnect</code>. </p>
<p>
  <code class="pre">public void Disconnect() <br />
  { <br />
    string message; <br />
    string response;<br />
    message = "QUIT\r\n"; <br />
    Write(message); <br />
    response = Response(); <br />
    if (response.Substring(0, 3) != "+OK") <br />
    { <br />
        throw new Pop3Exception(response); <br />
    } <br />
  }</code>
</p>
<p>The <code>Disconnect</code> method sends a <code>QUIT</code> message to the
  POP3 server.</p>
</div>

<ul class="page-navigation">
    <li class="prev"><a href="/article/4071/how-to-pop3-in-c/2/">Getting Started</a></li><li class="next"><a href="/article/4071/how-to-pop3-in-c/4/">Retrieving Messages</a></li>
</ul>


<div id="comments">
    <h2>Comments</h2>
    
<ol class="comment-list">

    <li class="clearfix">
        <div class="author"><a href="/profile/baeltazor/">jason pezzimenti</a></div>
        <div class="date">06 Dec 2009 at 10:05</div>
        <div class="comment cms-content"><!--removed tag--><p>This code does not work for me. It comes up with red squiggly lines under the Response() and Write words in the code. And it tells me to generate a method stub!???</p></!--removed tag--></div>
    </li>
 
    <li class="clearfix">
        <div class="author"><a href="/profile/riry/">riry setiawan</a></div>
        <div class="date">13 Nov 2009 at 02:36</div>
        <div class="comment cms-content"><!--removed tag--><p>hi all  ,I have tried </p><p>but it does't work ,the message is :
&quot;-ERR Cannot connect to POP server 206.190.46.10 (206.190.46.10:110), connect error 10060\r\n&quot;</p><p>anyone can help ??</p><p>thanks
riry</p><p>//-----------------------------------------------
private void button1_Click(object sender, EventArgs e)
        {
            try
            {
                Pop3 obj = new Pop3();
                obj.Connect(&quot;pop3.yahoo.com&quot;, &quot;myusername&quot;, &quot;mypassword&quot;);
                ArrayList list = obj.List();
                foreach (Pop3Message msg in list)
                {
                    Pop3Message msg2 = obj.Retrieve(msg);
                    System.Console.WriteLine(&quot;Message {0}: {1}&quot;,
                        msg2.number, msg2.message);
                }
                obj.Disconnect();
            }
            catch (Pop3Exception ex)
            {
                MessageBox.Show(ex.Message);
            }
            catch (System.Exception ex)
            {
                MessageBox.Show(ex.Message);
            } 
        }</p></!--removed tag--></div>
    </li>
 
    <li class="clearfix">
        <div class="author"><a href="/profile/bishnu.tewary/">Bishnu Tewary</a></div>
        <div class="date">22 Jun 2009 at 14:22</div>
        <div class="comment cms-content"><!--removed tag--><p>When i change the port to 587 from 110 i got the following error</p><p>220 mx.google.com ESMTP g14sm11215098rvb.54</p></!--removed tag--></div>
    </li>
 
    <li class="clearfix">
        <div class="author"><a href="/profile/bishnu.tewary/">Bishnu Tewary</a></div>
        <div class="date">22 Jun 2009 at 14:17</div>
        <div class="comment cms-content"><!--removed tag--><p>Hi Got the following  error when i try to call</p><p>obj.Connect(&quot;smtp.gmail.com&quot;, txtUser.Text, txtPass.Text);</p><p>A Connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host failed to respond 209.85.199.111: 110</p><p>Can any body please help me to fix this error?</p></!--removed tag--></div>
    </li>
 
    <li class="clearfix">
        <div class="author"><a href="/profile/sonali.k.mane/">sonali mane</a></div>
        <div class="date">01 Jun 2009 at 03:58</div>
        <div class="comment cms-content"><!--removed tag--><p>Your code is too good.
But in your code what happen If i send email today it display that email & tomarrow it show empty inbox. if i again send email it display that new mail only.
And i also want to fetch Email subject,Email Body then what i do.
Please give solution</p></!--removed tag--></div>
    </li>
 
    <li class="clearfix">
        <div class="author"><a href="/profile/ezekiel/">Evil Ezekiel</a></div>
        <div class="date">19 Jan 2009 at 19:20</div>
        <div class="comment cms-content">**<a href="http://imageshack.us"><img src="http://img88.imageshack.us/img88/8177/errorsocketgy7.jpg" border="0" alt="Image Hosted by ImageShack.us"/></a><br/><a href="http://g.imageshack.us/img88/errorsocketgy7.jpg/1/"><img src="http://img88.imageshack.us/img88/errorsocketgy7.jpg/1/w325.png" border="0"></a>**</div>
    </li>
 
    <li class="clearfix">
        <div class="author"><a href="/profile/ezekiel/">Evil Ezekiel</a></div>
        <div class="date">19 Jan 2009 at 19:20</div>
        <div class="comment cms-content">**I JUST GOT ERROR!!!!!! PLZ RESOLVE THIS ISSUE!!!!
[URL=http://imageshack.us][IMG]http://img88.imageshack.us/img88/8177/errorsocketgy7.jpg[/IMG][/URL]
[URL=http://g.imageshack.us/img88/errorsocketgy7.jpg/1/][IMG]http://img88.imageshack.us/img88/errorsocketgy7.jpg/1/w325.png[/IMG][/URL]**</div>
    </li>
 
    <li class="clearfix">
        <div class="author"><a href="/profile/ezekiel/">Evil Ezekiel</a></div>
        <div class="date">19 Jan 2009 at 18:38</div>
        <div class="comment cms-content">**    TcpClient tcpClient=new TcpClient();**</div>
    </li>
 
    <li class="clearfix">
        <div class="author"><a href="/profile/ezekiel/">Evil Ezekiel</a></div>
        <div class="date">19 Jan 2009 at 18:13</div>
        <div class="comment cms-content">**I don't know when this code was written but i do need to reference the TcpClient.Connect method!
Guys who got confused like me do, TcpClient tcpClient=new TcpClien();
tcpClient.Connect();**</div>
    </li>
 
    <li class="clearfix">
        <div class="author"><a href="/profile/ravimsk27/">Ravi  M </a></div>
        <div class="date">08 Dec 2008 at 10:22</div>
        <div class="comment cms-content">I t  was cool needed quite alobarated to get the Mail.Body for specific Details...



Thanks </div>
    </li>
 
</ol>

    <div class="post-comment clearfix">
        <h3>Leave a comment</h3>
        
        <p><a href="/user/signin/?returnUrl=%2Farticle%2F4071%2Fhow-to-pop3-in-c%2F3%2F%23comments">Sign in</a> or <a href="/user/joinus/?returnUrl=%2Farticle%2F4071%2Fhow-to-pop3-in-c%2F3%2F%23comments">Join us</a> (it's free).</p>
        
    </div>
</div>

<div class="related-tags">
    <h2>Related tags</h2>
    <a href="/tag/cpp/">c++</a>, <a href="/tag/email/">email</a>, <a href="/tag/pop3/">pop3</a>, <a href="/tag/sockets/">sockets</a>, <a href="/tag/tcp+ip/">tcp ip</a>
       
</div>

    <div id="author-info">
        <img src="/resource/get/user/20139/image/" alt="Randy Charles Morin" />
        Randy's article are Copyright 1998-2003 Randy Charles Morin
    </div>    
</div>

    </div>
    <div id="secondary-content" class="clearfix">
        

<div class="panel">
    <h2>Related articles </h2>
    <ul>
    
        <li><a href="/article/4039/custom-smtp-in-c/">Custom SMTP in C#</a></li>
    
        <li><a href="/code/2453/send-receive-emails-using-winsock-and-pop3/">Send &amp; Receive Emails using Winsock and POP3</a></li>
    
        <li><a href="/article/4444/business-logic-processing-in-a-socket-server/">Business logic processing in a socket server</a></li>
    
        <li><a href="/article/4406/handling-multiple-socket-read-write-operations/">Handling multiple socket read &amp; write operations</a></li>
    
    </ul>
</div>

<div class="panel">
    <div class="ask-question"><a href="/forum/post/">Ask a question</a></div>
    <h2>Related <a href="/forum/"> discussion</a></h2>
    
    <ul class="discuss">
        
        <li>
            <h3><a href="/forum/thread/55526/">How to POP3 in C#</a></h3>
            <h4> by baeltazor <span style="font-weight: bold;">(10 replies)</span></h4>
        
        </li>
    
    </ul>
    
</div>

<div id="ad-mpu"></div>


<div class="panel">
    <h2>Related <a href="/library/podcasts/">podcasts</a></h2>
    <ul>
    
        <li>
            <h3><a href="/media/8416/moving-your-email-into-the-cloud-google-for-apps-and-live-custom-domains/">Moving your Email into the Cloud - Google for Apps and Live Custom Domains</a></h3>
            <p>Scott and Carl talk about Scott's Family's recent move to Google Apps and Carl considers moving to Live Custom Domains. What are the benefits of moving your life into the cloud?</p>
        </li>
    
    </ul>
</div>

        <div id="ad-whitepaper"></div>
    </div>
    <p></p>
    
<div id="ad-leaderboard"></div>
</div>
<div id="sitemap">
    <div id="sitemap-content">
        <div class="section">
        <h3>Languages</h3>
        <ul>
            <li><a href="/tag/csharp/">C# Programming</a></li>
            <li><a href="/tag/vb.net/">VB.NET</a></li>
            <li><a href="/tag/java/">Java</a></li>
            <li><a href="/tag/cpp/">C++</a></li>
        </ul>
        </div>
        <div class="section">
        <h3>Web Development</h3>
        <ul>
            <li><a href="/tag/asp.net/">ASP.NET</a> (<a href="http://quickstart.developerfusion.co.uk/quickstart/">Quickstart</a>)</li>
            <li><a href="/tag/php/">PHP</a></li>
            <li><a href="/tag/javascript/">JavaScript</a></li>
            <li><a href="/tag/css/">CSS</a></li>
        </ul>
        </div>
        <div class="section">
        <h3>Frameworks &amp; Architecture</h3>
        <ul>
            <li><a href="/tag/.net/">.NET Framework</a></li>
            <li><a href="/tag/java/">Java</a></li>
            <li><a href="/tag/patterns/">Patterns</a></li>
            <li><a href="/tag/tdd/">Test Driven Development</a></li>
        </ul>
        </div>
        <div class="section">
        <h3>Other major sections</h3>
        <ul>
            <li><a href="/forum/">.NET Forum</a></li>
            
            <li><a href="/library/media/">Podcasts</a></li>
            <li><a href="/marketplace/books/">Software books</a></li>
        </ul>
        </div>
    </div>
</div>
<div id="members">
    <div class="member-panel">
        <ul>

        <li class="first" id="join-us"><a href="/user/joinus/?returnUrl=%2Farticle%2F4071%2Fhow-to-pop3-in-c%2F3%2F">Join us</a></li>
        <li id="sign-in"><a href="/user/signin/?returnUrl=%2Farticle%2F4071%2Fhow-to-pop3-in-c%2F3%2F">Sign in</a></li>

        <li class="country"><img src="http://cdn.developerfusion.com/images/shared/shim.gif" class="country-icon country-icon-es" alt="Spain" title="Spain" /> <a href="/community/europe/es/">Spain</a></li>
    </ul>


    <div id="sign-in-panel">
        <form action="/user/signin/?returnUrl=%2Farticle%2F4071%2Fhow-to-pop3-in-c%2F3%2F" method="post">
            <fieldset>
            <label for="QuickSignInUsername">Username</label><input class="text" id="QuickSignInUsername" type="text" name="Username" />
            <label for="QuickSignInPassword">Password</label><input class="text" id="QuickSignInPassword" type="password" name="Password" />
            <input type="hidden" name="RememberMe" value="true" />
            <input type="submit" value="Sign in" />
            </fieldset>
            <div class="cancel"><a href="#">Cancel</a></div>
        </form>
    </div>

<div class="message">
        We'd love to hear what you think! <a href="http://feedback.developerfusion.com/">Submit ideas or give us feedback</a>
    </div>
    </div>
    
</div>

<div id="footer" class="clearfix">
    <div id="footer-content">
        <ul>
            <li><a rel="nofollow" href="http://feedback.developerfusion.com/">Send feedback</a></li>
            <li><a href="http://blog.developerfusion.com/">Blog</a></li>
            <li><a href="/info/about/" rel="nofollow">About us</a></li>
            <li><a href="/info/contact/" rel="nofollow">Contact us</a></li>
            <li><a href="/info/advertise/" rel="nofollow">Advertise</a></li>
        </ul>
        <div class="copyright">&copy; <a href="/info/legal/" rel="nofollow">1999-2010 Developer Fusion Ltd</a></div>
        <div class="hosted-by"><a href="http://d1.openx.org/ck.php?bannerid=41996">Web hosting by UKFast</a></div>
    </div>
</div>
</div>

<script type="text/javascript" src="http://cdn.developerfusion.com/scripts/site.compressed.js"></script>

<script type="text/javascript">
if (window.Site) {
    var SiteInstance = new Site({ assetUrl : 'http://cdn.developerfusion.com/', hasLeaderboard : true, debug : false });
}
</script>
<script type="text/javascript" src="http://www.google-analytics.com/ga.js"></script>
<script type="text/javascript">    if (window._gat) { var pageTracker = _gat._getTracker("UA-5768144-1"); pageTracker._trackPageview(); }</script>

<div id="adloader-leaderboard"><script type="text/javascript">if (window.SiteInstance) SiteInstance.writeNSAd('728x90');</script></div>
<div id="adloader-mpu"><script type="text/javascript">if (window.SiteInstance) SiteInstance.writeNSAd('300x250');</script></div>

<script type="text/javascript" src="http://track.netshelter.net/js/sites/developerfusion.com.js"></script>
</body>
</html>
