<!doctype html><link rel=canonical href=http://dotnetperls.com/datagridview-tutorial><link rel="shortcut icon" href=http://d142qn1ou6ht8n.cloudfront.net/1><title>C# DataGridView Tutorial</title><style>body,img,iframe{border:0;margin:0;padding:0}body{font:14px/1.45 verdana,sans-serif;position:relative;background:#fff}h1{font:27px/1.2 verdana,sans-serif;padding:20px 0 0;margin:0 300px 0 0;font-weight:700}h2{font-size:18px;margin:0 10px}#e{border-bottom:solid 1px #919191;background:#fff;padding:0 0 40px;min-height:800px}#t{font-size:13px;position:absolute;top:0;right:0;background:#40627c;padding:7px 9px;color:#fff}#t a{color:#fff}#a{font-size:11px;margin:0 0 13px;padding:0 0 6px 10px;background:#fffae4}#r{font-size:11px;bottom:0;padding:0 300px 30px 10px;position:absolute}p,#e img{margin:0 10px 12px;display:block}img{vertical-align:middle}.l{font-size:13px;margin-top:-12px;font-weight:700}.l a{text-decoration:none}.l a:hover{text-decoration:underline}::selection{background:#afeeee}::-moz-selection{background:#afeeee}pre{font-size:13px;margin:0 10px 12px;padding:6px 0;line-height:normal}pre i{color:green;font-style:normal}</style><div id=e><div id=a><h1>C# DataGridView Tutorial</h1>by Sam Allen - Updated January 8, 2010</div><div style=margin-right:300px><p>You want to use the <b>DataGridView control</b> for displaying data from your SQL database. Display a table from the database on the DataGridView, using DataAdapter and data logic. Here we review steps to set up a DataGridView, generate an SQL database, and then render it, using the C# programming language.</p><img src=a3 width=391 height=264 alt="DataGridView tutorial screenshot"><h2>Make new Windows Forms application</h2><p>In Visual Studio 2008, select the File menu and then New Project, and select a Windows Forms application. Next, in the designer, drag the DataGridView icon into the window. On the right part of your Window you will see the Visual Studio Toolbox. It contains the icons and controls you can add. Select View and then Toolbox to show it.</p><img src=au width=433 height=405 alt="Adding the DataGridView in Visual Studio" style="border:1px solid gray"><h2>Using databases</h2><p>Here we need to generate a simple SDF file for the rest of the program to interact with. We will use Visual Studio for this part. First, go to Data and then Add New Data Source. This is the Visual Studio wizard that you can use to add a new database.<p><b>Database creation.</b> Select Database, and click Next. Click on New Connection, as we need to create an all-new connection and database. We are not reusing one that already exists.<h2>Create new database</h2><p>Type in a database name, and then click Create. Note that we are using SQL Server CE, which is the compact edition of SQL Server 2005. You will use different dialogs to configure SQL Server 2005. You will get the connection string at this point. The one given to me is as follows:<pre>Data Source=C:\Users\Sam\Documents\Data.sdf</pre><p><b>Following steps.</b> Next, you will see the "Save the Connection String to the Application Configure File" dialog. Select "Yes, save the connection as" DataConnectionString.<h2>Create simple table</h2><p>The database you are using must have some tables containing row data. To keep this document as simple as possible, I create an example table. First, open Server Explorer. The Server Explorer is a pane in the right side of Visual Studio normally. Select your SDF database, and right click on the Tables folder. Type in the table name. For my example, I use a table name of "Animals". Type this in the Name: text box.<p><b>Next steps.</b> Click in "Column Name" cell. Click in the empty cell under Column Name and type your column's name. I create a column named "Weight" with a data type of Numeric. To complete this step in the tutorial, click OK.</p><img src=aw width=558 width=434 alt="Creating database in Visual Studio"><h2>Add data to table in Visual Studio</h2><p>Next, we need to have actual data in the table we created. Return to the Server Explorer, and right-click on the table, such as the Animals table. Type in 10 for Weight, and brown for Color. This data is just for the example, but your program may have similar fields. We could be working on a table for a veterinarian's office. Repeat for other rows.<pre>Weight: 10
Color:  Brown

Weight: 15
Color:  Black

Weight: 5
Color:  Green

Weight: 20
Color:  White</pre><h2>Set up Windows Forms program</h2><p>At this point you have a special database as part of your C# Windows Forms program. It has one table and four rows, and you want to use a DataAdapter with your DataGridView.<p><b>Adding directive.</b> Before you add logic, add the SqlCeServer directive at the top of your Windows Forms program's code. When you use different database engines, you will need different directives.<pre>using System.Data.SqlServerCe;</pre><h2>Add data adapter code</h2><p>In C# code, you must open a connection to your database first, and then create a DataAdapter. There are different adapter implementations, but they all work similarly. For this tutorial, we will use the SqlCeDataAdapter. You are likely not using this exact database provider, but the code is exactly the same for SQL Server 2005 and many others. Make sure your program has the using System.Data and using System.Data.SqlServerCe directives at the top. Now, add the following custom FillData method.</p><p class=l><a href=sqlclient-tutorial>(See SqlClient Tutorial.)</a><pre>using System.Data;
using System.Data.SqlServerCe;
using System.Windows.Forms;

namespace WindowsFormsApplication5
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
            <b>FillData</b>();
        }

        void <b>FillData</b>()
        {
            <i>// 1
            // Open connection</i>
            using (SqlCeConnection c = new SqlCeConnection(
                Properties.Settings.Default.DataConnectionString))
            {
                c.Open();
                <i>// 2
                // Create new DataAdapter</i>
                using (SqlCeDataAdapter a = new SqlCeDataAdapter(
                    "SELECT * FROM Animals", c))
                {
                    <i>// 3
                    // Use DataAdapter to fill DataTable</i>
                    DataTable t = new DataTable();
                    a.Fill(t);
                    <i>// 4
                    // Render data onto the screen</i>
                    <b><u>dataGridView1.DataSource = t</u></b>;
                }
            }
        }
    }
}</pre><p><b>Description.</b> It calls FillData after InitializeComponent, which is autogenerated by Visual Studio. Look at the FillData method, which is where we put the database contents into the DataGridView.<p><b>Step 1.</b> It opens a connection to the database we created earlier in the tutorial. We use the Properties.Settings.Default.DataConnectionString string, which was autogenerated by Visual Studio.<p><b>Step 2.</b> It uses a new DataAdapter, in this case SqlCeDataAdapter. What DataAdapters allow us to do is specify a command, similar to SqlCommand, but use it to directly fill a DataSet or DataTable.<p><b>Step 3.</b> It assigns the DataSource in the DataGridView, which renders the contents of the database onto the screen. This is the result of the tutorial so far:</p><img src=az width=332 height=332 alt="DataGridView using DataSource"><h2>DataSet vs. DataTable</h2><p>The DataSet object available in System.Data has a slightly different purpose than DataTable, as it allows more information to be stored. However, for this tutorial, DataTable is adequate.<p><b>Understanding DataSet.</b> "The DataSet consists of a collection of DataTable objects that you can relate to each other with DataRelation objects. You can also enforce data integrity in the DataSet..."</p><p class=l><a href=http://msdn.microsoft.com/en-us/library/system.data.dataset.aspx>(Visit msdn.microsoft.com.)</a><p><b>Understanding DataTable.</b> "The DataTable is a central object in the ADO.NET library. Other objects that use the DataTable include the DataSet and the DataView."</p><p class=l><a href=http://msdn.microsoft.com/en-us/library/system.data.datatable.aspx>(Visit msdn.microsoft.com.)</a><h2>Improve DataGridView</h2><p>The default DataGridView appearance and functionality is not usually the best. Here we make some tweaks to the DataGridView to make it more pleasing.<p><b>First improvement steps.</b> Expand and anchor the DataGridView. Use the Anchor property on the DataGridView in the designer view to "pin" it to each edge of your window. Go to Properties, and then Layout, and then Anchor.<p><b>Appearance steps.</b> Change the background. Usually, developers need to change the backgrounds of the DataGridView. Make it white by changing the Appearance and then BackgroundColor from AppWorkspace to Window. Hide the row headers. Go to Appearance and then RowHeadersVisible and change it to False.<p><b>Altering the selection mode option.</b> Change the SelectionMode property. There are several SelectionMode enums you can use: CellSelect, FullRowSelect, FullColumnSelect, RowHeaderSelect, and ColumnHeaderSelect. Change the one in this tutorial to FullRowSelect.<p><b>Tutorial progress.</b> What we have so far is a single window with a DataGridView that expands, rows that are selected the entire way across, and the data from our database being fully displayed from a DataAdapter.<h2>Options</h2><p>DataGridView has a myriad of options and this is both its biggest advantage, and its most frustrating difficulty. You can see many options in the DataGridView property article.</p><p class=l><a href=datagridview-property>(See DataGridView Property Notes.)</a><h2>Add columns</h2><p>With the DataGridView, you can predefine columns for display. This doesn't actually display anything, but you create the rules by which the actual data will be displayed. This is ideal for when you want to have the first column have a width of 200px, for example. For the tutorial, we want the Animal table's Weight column to be 110px wide.<p><b>First column steps.</b> Go to Properties and then Misc, and then Columns. This shows the Edit Columns dialog box. Click on the Add... button the bottom left. Change the Unbound column. An Unbound column is one that is not directly linked to a DataSource. Note that sometimes it is easier to use the DataSource directly.<p><b>Next steps.</b> Change the header text. The text you type into the Header text: text box will ensure that the text is always shown. This means you can display a different form of the column's name than is in the actual DataTable and database. For the example, I will change the Weight cell header to "Weight (lbs.)". This ensures the application's users will know to use pounds, not kilograms. [See DataPropertyName below]<p><b>Final column steps.</b> Finally, change the properties. You need to change the properties of the DataGridViewColumn in the dialog box that appears. I set 110px as the width, and AutoSizeMode of None.<h2>Change DataPropertyName</h2><p>You need to specify that a certain column in your database be inserted into the Column you just added in the Columns dialog box. To do this, you must assign the DataPropertyName of the column to the column name from your database. For example, to specify that your DataGridViewColumn be used for the Weight column for your database, type "Weight" into the DataPropertyName box.<h2>Column properties</h2><p>When using DataGridView you will need to change column properties. The collection of properties available is in the DataGridView Property article.</p><p class=l><a href=datagridview-property>(See DataGridView Property Notes.)</a><h2>Alternating row colors</h2><p>For usability, you want to have alternating row colors on your DataGridView. Fortunately, newer versions of the .NET framework have the AlternatingRowsDefaultCellStyle attribute. Click to change that property. Change the BackColor to something your users will like to look at, and that will improve the program's usability. For my example, I chose aqua.</p><img src=a0 width=332 height=332 alt="DataGridView example for tutorial"><h2>Finishing touches</h2><p>Here I just apply some more tricks to improve the appearance and usability. At the top you can see the final result from this tutorial. First, I added another column property. I repeated the instructions shown in the Columns topic to add another column template for the next column.<p><b>Next finishing touches.</b> I changed AllowUserToAddRows. This eliminates the blank row on the bottom of the DataGridView. I changed the BorderStyle. I choose to use the best style for Vista here and chose Fixed3D. The other border, FixedSingle, looks better in Windows XP. The None option might be good for some programs.<p><b>Column header styles and fonts.</b> I changed the ColumnHeaderBorderStyle. For Vista, the best appearance is None here. For completeness, the enums are Custom, Single, Raised, Sunken, and None. My experience is that none of them look really good on Vista. I changed the Font. I also modified some properties of the entire program, such as the form's Text.<h2>Summary</h2><p>Here we saw how you can use a database and display its contents in a usable <b>DataGridView</b>. This is critical for many data-driven Windows Forms application. The example shown here could form the foundation of a data-driven application for veterinarian's office. When a dog-owner arrives and his dog is sick, the vet employee could record the species, weight, and color of the dog.</p><p class=l><a href=copyright>(Do not copy this page.)</a></div></div><div style=height:440px></div><div id=r><a href=.><b>Dot Net Perls</b></a> | <a href=http://www.google.com/search?sitesearch=dotnetperls.com&q=*>Search</a><br><a href=datagridview><b>DataGridView</b></a> | <a href=datagridview-columns>DataGridView Columns, Edit Columns Dialog</a> | <a href=datagridview-property>DataGridView Property Notes</a> | <a href=datagridview-tips>DataGridView Tips and Secrets</a> | <a href=datagridview-vbnet>DataGridView Usage</a> | <a href=previewkeydown>PreviewKeyDown Event</a><br>C# | <a href=decrement>Decrement Int</a> | <a href=html-brackets>HTML Brackets</a> | <a href=parameter-optimization>Parameter Optimization Tip</a> | <a href=savefiledialog>SaveFileDialog Tutorial</a></div><div style=position:absolute;font-size:10px;right:10px;bottom:4px>&copy; 2010 Sam Allen. All rights reserved.</div><div id=t><a href=.><b>Dot Net Perls</b></a> | <a href=about>Sam Allen</a><img src=http://d142qn1ou6ht8n.cloudfront.net/2 width=50 height=50 style="margin:-7px -9px -7px 9px;opacity:0.9"></div><div style=position:absolute;top:61px;right:0><script>lqm_channel=1;lqm_publisher=323;lqm_zone=1;lqm_format=6;</script><script src=http://a.lakequincy.com/s.js></script></div><div style=position:absolute;top:320px;right:0;background:#fff><script>lqm_channel=1;lqm_publisher=323;lqm_zone=1;lqm_format=6;</script><script src=http://a.lakequincy.com/s.js></script><br><br><div style=width:250px;font-size:10px;line-height:normal><script>lqm_channel=1;lqm_publisher=323;lqm_zone=1;lqm_format=3;</script><script src=http://a.lakequincy.com/s.js></script><br><br><script>lqm_channel=1;lqm_publisher=323;lqm_zone=1;lqm_format=3;</script><script src=http://a.lakequincy.com/s.js></script></div></div><div style=position:absolute;bottom:148px><script>lqm_channel=1;lqm_publisher=323;lqm_zone=1;lqm_format=7;</script><script src=http://a.lakequincy.com/s.js></script></div><div style=position:absolute;bottom:148px;left:350px><script>lqm_channel=1;lqm_publisher=323;lqm_zone=1;lqm_format=7;</script><script src=http://a.lakequincy.com/s.js></script></div>