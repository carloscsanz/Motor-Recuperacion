<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />

<link rel="shortcut icon" href="http://www.keyongtech.com/img/favicon.ico" />
<link rel="stylesheet" type="text/css" href="http://www.keyongtech.com/css/hilpers.css" />

<title>Excel Header and Footer Font from c# | keyongtech</title>
</head>
<body>
<table border="0" width="800" cellpadding="0" cellspacing="0" align="center">
<tr>
<td align="left"><p><a href="http://www.keyongtech.com/"><img src="http://img.hilpers.net/hilpers_logo.png" width="150" height="35" border="0" alt="keyongtech" /></a></p></td>
</tr>
</table>
<div align="center"><div class="page" style="width:800px; text-align:left"><div style="padding:0px 25px 0px 25px">
<br />
<table class="tborder" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tr>
<td class="alt1">

<table cellpadding="0" cellspacing="0" border="0">
<tr valign="bottom">
<td><img src="http://img.hilpers.net/nav1.png" width="15" height="15" border="0" alt="" /></td>
<td>&nbsp;</td>
<td width="100%"><span class="navbar"><a href="http://www.keyongtech.com/">keyongtech</a></span> 
	<span class="navbar">&gt; <a href="http://www.keyongtech.com/dotnet-languages/">dotnet.languages.*</a></span>


	<span class="navbar">&gt; <a href="http://www.keyongtech.com/dotnet-languages-csharp/">dotnet.languages.csharp</a></span>



<span class="navbar">&gt; <a href="http://www.keyongtech.com/dotnet-languages-csharp/3408">12/2003</a></span>

</td>
</tr>
<tr>
<td class="navbar" style="font-size:10pt; padding-top:1px" colspan="3"><img class="inlineimg" src="http://img.hilpers.net/nav2.png" width="30" height="15" border="0" alt="" /> <strong>
	Excel Header and Footer Font from c#

 </strong></td>
</tr>
</table>			

</td>
</tr>
</table>
<br />
<table cellpadding="0" cellspacing="0" border="0" width="100%" style="margin-bottom:6px">
<tr valign="bottom">
<td></td>
</tr>
</table>
</div></div></div>
<div>
<div align="center"><div class="page" style="width:800px; text-align:left"><div style="padding:0px 25px 0px 25px">
<div style="padding:0px 0px 6px 0px">


<table class="tborder" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tr>
<td class="thead">
<div class="normal" style="float:right">
&nbsp;#<a href="http://www.keyongtech.com/623631-excel-header-and-footer-font#1" name="1"><strong>1</strong></a> &nbsp;
</div>
<div class="normal">
<img class="inlineimg" src="http://img.hilpers.net/post.png" width="10" height="11" border="0" alt="" />
12-01-03, 10:30 PM
</div>
</td>
</tr>
<tr>
<td class="alt2" style="padding:0px">
<table cellpadding="0" cellspacing="6" border="0" width="100%">
<tr>
<td nowrap="nowrap">
<div class="username">John hoffman</div>
</td>
</tr>
</table>
</td>
</tr>
<tr>
<td class="alt1">

<div>Hello,<br />
<br />
I am trying to set the MS Excel header and footer font<br />
using automation from C#.<br />
<br />
I can set the text using:<br />
<br />
oPageSetup.LeftHeader = &quot;Header Text&quot;;<br />
<br />
but how do you set the Font size????<br />
<br />
<br />
TIA,<br />
<br />
John Hoffman</div>
</td>
</tr>
</table>



</div>
</div></div></div>


<div align="center"><div class="page" style="width:800px; text-align:left"><div style="padding:0px 25px 0px 25px">
<div style="padding:0px 0px 6px 0px">

<table class="tborder" align="center" border="0" cellpadding="6" cellspacing="1" width="100%">
<tbody>
<tr>
<td class="alt1">
<div>
<script type="text/javascript"><!--
google_ad_client = "pub-7614327903740968";
google_ad_slot = "3568063523";
google_ad_width = 336;
google_ad_height = 280;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>
</td>
</tr>
</tbody></table>



</div>
</div></div></div>

<div align="center"><div class="page" style="width:800px; text-align:left"><div style="padding:0px 25px 0px 25px">
<div style="padding:0px 0px 6px 0px">


<table class="tborder" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tr>
<td class="thead">
<div class="normal" style="float:right">
&nbsp;#<a href="http://www.keyongtech.com/623631-excel-header-and-footer-font#2" name="2"><strong>2</strong></a> &nbsp;
</div>
<div class="normal">
<img class="inlineimg" src="http://img.hilpers.net/post.png" width="10" height="11" border="0" alt="" />
12-02-03, 08:08 AM
</div>
</td>
</tr>
<tr>
<td class="alt2" style="padding:0px">
<table cellpadding="0" cellspacing="6" border="0" width="100%">
<tr>
<td nowrap="nowrap">
<div class="username">Steven Van Loon</div>
</td>
</tr>
</table>
</td>
</tr>
<tr>
<td class="alt1">

<div>I don't know how to do that, but I have a way to discover how excel does<br />
things:<br />
start excel, start recording a macro, look what the code does and then use<br />
that code in your automation project. Simple but it works often.<br />
<br />
Steven.<br />
<br />
<br />
&quot;John hoffman&quot; &lt;john.hoffman&gt; wrote in message<br />
news:280a<br />
[..]</div>
</td>
</tr>
</table>




</div>
</div></div></div>

<div align="center"><div class="page" style="width:800px; text-align:left"><div style="padding:0px 25px 0px 25px">
<div style="padding:0px 0px 6px 0px">


<table class="tborder" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tr>
<td class="thead">
<div class="normal" style="float:right">
&nbsp;#<a href="http://www.keyongtech.com/623631-excel-header-and-footer-font#3" name="3"><strong>3</strong></a> &nbsp;
</div>
<div class="normal">
<img class="inlineimg" src="http://img.hilpers.net/post.png" width="10" height="11" border="0" alt="" />
12-02-03, 12:19 PM
</div>
</td>
</tr>
<tr>
<td class="alt2" style="padding:0px">
<table cellpadding="0" cellspacing="6" border="0" width="100%">
<tr>
<td nowrap="nowrap">
<div class="username">Wei-Dong Xu [MSFT]</div>
</td>
</tr>
</table>
</td>
</tr>
<tr>
<td class="alt1">

<div>Hi John,<br />
<br />
Thank you for posting in MSDN managed newsgroup!<br />
<br />
You can join the font type with the header size. I list sample code below:<br />
'Code begin<br />
ActiveSheet.PageSetup.LeftHeader = &quot;&amp;&quot;&quot;Arial Unicode MS,Regular&quot;&quot;Header Text&quot;<br />
'Code end<br />
<br />
You can append the head text or foot text after &quot;&amp;&quot;&quot;font type name&quot;&quot;&lt;header or foorter text&gt;&quot;.<br />
<br />
Furthermore, you can also try the method Steven suggested which will be very fast for you to create the macro code.<br />
<br />
Please feel free to let me know if you have any further questions.<br />
<br />
Does this answer your question? Thank you for using Microsoft NewsGroup!<br />
<br />
Wei-Dong Xu<br />
Microsoft Product Support Services<br />
Get Secure! - [url down]<br />
This posting is provided &quot;AS IS&quot; with no warranties, and confers no rights.</div>
</td>
</tr>
</table>




</div>
</div></div></div>

<div align="center"><div class="page" style="width:800px; text-align:left"><div style="padding:0px 25px 0px 25px">
<div style="padding:0px 0px 6px 0px">


<table class="tborder" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tr>
<td class="thead">
<div class="normal" style="float:right">
&nbsp;#<a href="http://www.keyongtech.com/623631-excel-header-and-footer-font#4" name="4"><strong>4</strong></a> &nbsp;
</div>
<div class="normal">
<img class="inlineimg" src="http://img.hilpers.net/post.png" width="10" height="11" border="0" alt="" />
12-02-03, 08:28 PM
</div>
</td>
</tr>
<tr>
<td class="alt2" style="padding:0px">
<table cellpadding="0" cellspacing="6" border="0" width="100%">
<tr>
<td nowrap="nowrap">
<div class="username">John Hoffman</div>
</td>
</tr>
</table>
</td>
</tr>
<tr>
<td class="alt1">

<div>Hello Wei-Dong,<br />
<br />
The sample code you sent:<br />
ActiveSheet.PageSetup.LeftHeader = &quot;&amp;&quot;&quot;Arial Unicode<br />
MS,Regular&quot;&quot;Header Text&quot;<br />
<br />
below is NOT valid C# syntax. (I believe it is the VB<br />
macro code.)<br />
<br />
I have tried<br />
ActiveSheet.PageSetup.LeftHeader = &quot;&amp;&quot; + &quot;Arial Unicode<br />
MS,Regular&quot; + &quot;Header Text&quot;;<br />
<br />
but that just gives me the literal text in the header.<br />
<br />
Any help would be appreciated.<br />
<br />
TIA,<br />
<br />
John Hoffman<br />
<br />
<span class="c1"><br />
&gt;-----Original Message-----<br />
&gt;Hi John,<br />
&gt;<br />
&gt;Thank you for posting in MSDN managed newsgroup!<br />
&gt;<br />
&gt;You can join the font type with the header size. I list</span><br />
sample code below:<span class="c1"><br />
&gt;'Code begin<br />
&gt;ActiveSheet.PageSetup.LeftHeader = &quot;&amp;&quot;&quot;Arial Unicode</span><br />
MS,Regular&quot;&quot;Header Text&quot;<span class="c1"><br />
&gt;'Code end<br />
&gt;<br />
&gt;You can append the head text or foot text after &quot;&amp;&quot;&quot;font</span><br />
type name&quot;&quot;&lt;header or foorter text&gt;&quot;.<span class="c1"><br />
&gt;<br />
&gt;Furthermore, you can also try the method Steven</span><br />
suggested which will be very fast for you to create the<br />
macro code.<span class="c1"><br />
&gt;<br />
&gt;Please feel free to let me know if you have any further</span><br />
questions.<span class="c1"><br />
&gt;<br />
&gt;Does this answer your question? Thank you for using</span><br />
Microsoft NewsGroup!<span class="c1"><br />
&gt;<br />
&gt;Wei-Dong Xu<br />
&gt;Microsoft Product Support Services<br />
&gt;Get Secure! - [..]<br />
&gt;This posting is provided &quot;AS IS&quot; with no warranties, and</span><br />
confers no rights.<br />
[..]</div>
</td>
</tr>
</table>




</div>
</div></div></div>

<div align="center"><div class="page" style="width:800px; text-align:left"><div style="padding:0px 25px 0px 25px">
<div style="padding:0px 0px 6px 0px">


<table class="tborder" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<tr>
<td class="thead">
<div class="normal" style="float:right">
&nbsp;#<a href="http://www.keyongtech.com/623631-excel-header-and-footer-font#5" name="5"><strong>5</strong></a> &nbsp;
</div>
<div class="normal">
<img class="inlineimg" src="http://img.hilpers.net/post.png" width="10" height="11" border="0" alt="" />
12-03-03, 08:17 AM
</div>
</td>
</tr>
<tr>
<td class="alt2" style="padding:0px">
<table cellpadding="0" cellspacing="6" border="0" width="100%">
<tr>
<td nowrap="nowrap">
<div class="username">Wei-Dong Xu [MSFT]</div>
</td>
</tr>
</table>
</td>
</tr>
<tr>
<td class="alt1">

<div>Hi John,<br />
<br />
Thank you for replying!<br />
<br />
In C#, the string [&quot;&amp;&quot;&quot;Arial Unicode MS,Regular&quot;&quot;Header Text&quot;] will be thought invalid by the complier for so many quotation in this string. We can<br />
use StringBuilder class to read this string and stringbuild class will transfer the string into one valid format which C# compiler prefers automatically.<br />
I write the sample codes for you.<br />
<br />
//Code begin<br />
//the stringbuilder class is in the System.Text namespace<br />
using System.Text;<br />
...<br />
try<br />
{<br />
Excel.Worksheet objWS;<br />
StringBuilder str = new StringBuilder();<br />
<br />
// the [&quot;&amp;&quot;&quot;Arial Unicode MS,Regular&quot;&quot;Header Text&quot;] will be transferred into<br />
// [&quot;&amp;\&quot;Arial Unicode MS,Regular\&quot;Header Text&quot;] by stringBuilder internally<br />
//  which is valid in C#<br />
str.Append(@&quot;&amp;&quot;&quot;Arial Unicode MS,Regular&quot;&quot;Header Text&quot;);<br />
<br />
objWS = (Excel.Worksheet)this.ThisApplication.ActiveSheet;<br />
objWS.PageSetup.LeftFooter = str.ToString();<br />
}<br />
catch(System.Exception ex)<br />
{<br />
MessageBox.Show(ex.Message);<br />
}<br />
//Code end<br />
<br />
Furthermore, in your project, I'd suggest you can also use stringbuilder to create your footer and header string very easily with the Append<br />
method.<br />
<br />
In addition, in Visual Basic.Net and VBA, we can directly pass the [&quot;&amp;&quot;&quot;Arial Unicode MS,Regular&quot;&quot;Header Text&quot;] string for the footer and header.<br />
<br />
Please feel free to let me know if you have any further questions.<br />
<br />
Does this answer your question? Thank you for using Microsoft NewsGroup!<br />
<br />
Wei-Dong Xu<br />
Microsoft Product Support Services<br />
Get Secure! - [url down]<br />
This posting is provided &quot;AS IS&quot; with no warranties, and confers no rights.</div>
</td>
</tr>
</table>




</div>
</div></div></div>


<div align="center"><div class="page" style="width:800px; text-align:left"><div style="padding:0px 25px 0px 25px">
<div style="padding:0px 0px 6px 0px"> 

<table class="tborder" align="center" border="0" cellpadding="6" cellspacing="1" width="100%">
<tbody>
<tr>
<td class="alt1">
<div>
<script type="text/javascript"><!--
google_ad_client = "pub-7614327903740968";
google_ad_slot = "3568063523";
google_ad_width = 336;
google_ad_height = 280;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>
</td>
</tr>
</tbody></table>


</div>
</div></div></div>
<div></div></div>
<div align="center"><div class="page" style="width:800px; text-align:left"><div style="padding:0px 25px 0px 25px">
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr valign="top">

<td>
</td>

</tr>
</table>
<table class="tborder" cellpadding="6" cellspacing="1" border="0" width="100%" align="center">
<thead>
<tr>
<td class="tcat" width="100%" colspan="2">
Similar Threads
</td>
</tr>
</thead>
<tr>
<td class="alt1" align="left"><span class="smallfont"><a href="http://www.keyongtech.com/5037674-font-on-the-footer-and">font on the footer and not the header.</a></span><p>
<span class="smallfont">I would like to change the font on the footer, but not the header.</span></p></td>
</tr><tr>
<td class="alt1" align="left"><span class="smallfont"><a href="http://www.keyongtech.com/1257949-font-size-of-header-footer">Font size of Header/Footer</a></span><p>
<span class="smallfont">When printing a web page, a user can change what to be printed in
header/footer by page set up, but cannot change the font size.
What determines font size of header/footer?...</span></p></td>
</tr><tr>
<td class="alt1" align="left"><span class="smallfont"><a href="http://www.keyongtech.com/3598632-header-footer-font-color">Header/footer font color</a></span><p>
<span class="smallfont">Hi!
I'm trying to set up a letter template with a company address and phone
numbers at the bottom of each page in a document but so it would not move
when people are typing...</span></p></td>
</tr><tr>
<td class="alt1" align="left"><span class="smallfont"><a href="http://www.keyongtech.com/940828-excel-footer-mass-change-of">Excel-Footer Mass change of only Header and not footer</a></span><p>
<span class="smallfont">In Excel,  there are 20 worksheets with independent header
and footers defined.

Now I need to change only header en-mass and without
changing the footer.  When I try to...</span></p></td>
</tr><tr>
<td class="alt1" align="left"><span class="smallfont"><a href="http://www.keyongtech.com/2725109-header-footer-font-size">Header/footer font size</a></span><p>
<span class="smallfont">Hi.  I use MS Internet Explorer as my browser.  I'm trying to modify the
font size of headers and footers, but without success.  I can modify the
font type, but not their...</span></p></td>
</tr>
</table>
<br />
</div></div></div>
<table cellpadding="6" cellspacing="0" border="0" width="800" class="page" align="center">
<tr>
<td class="tfoot" align="right" width="100%">
<div class="f1">
All times are GMT. The time now is 02:23 PM. | <a href="/privacy">Privacy Policy</a>
</div>
<div class="f2">
<a href="http://www.hilpers.com">Deutschland</a>
<a href="http://www.hilpers-esp.com">Espa√±a</a>
<a href="http://www.hilpers.fr">France</a>
<a href="http://www.hilpers.it">Italia</a>
<a href="http://www.hilpers.nl">Nederland</a>
<a href="http://www.hilpers.pl">Polska</a>
<a href="http://www.hilpers.org">United Kingdom</a>
</div>
</td>
</tr>
</table>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-6428583-8");
pageTracker._trackPageview();
} catch(err) {}</script>
</body>
</html>